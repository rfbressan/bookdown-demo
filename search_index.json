[
["index.html", "Introdução a Superfície de Volatilidade Prefácio", " Introdução a Superfície de Volatilidade Rafael Felipe Bressan 2019-01-19 Prefácio Este é um pequeno resumo, elaborado na forma de livro, sobre os estudos realizados pelo núcleo de derivativos e riscos do Clube de finanças ESAG. Os estudos realizados pelos membros do núcleo foram sendo apresentados na forma de artigos no blog do Clube. A partir destes artigos foi feita esta coletânea de forma a apresentar todo o conteúdo em local único para facilitar a assimilação dos membros futuros e leitores de nosso blog. "],
["sobre-os-autores.html", "Sobre os Autores Rafael Felipe Bressan", " Sobre os Autores Rafael Felipe Bressan Formado em Engenharia de Controle e Automação Industrial pela UFSC e aluno de graduação do curso de Ciências Econômicas na UDESC/Esag. Membro do Clube de Finanças Esag e gerente do núcleo de pesquisa em riscos e derivativos. Se interessa por finanças quantitativas, modelagem e controle de riscos e desenvolveu, durante a elaboração deste livro, grande curiosidade sobre precificação de derivativos. Gosta de programar em R, liguagem com a qual elaborou este próprio livro e está aprendendo Python. "],
["opcoes.html", "Capítulo 1 Introdução as opções 1.1 Conceitos in the money, at the money e out the money 1.2 Modelos americano e europeu de opções 1.3 Hedge 1.4 Travas", " Capítulo 1 Introdução as opções Neste Capítulo1 iremos apresentar os instrumentos financeiros conhecidos como opções. Existem dois tipos de opção. Uma opção de compra dá ao detentor o direito de comprar o ativo subjacente até uma determinada data por um determinado preço. Uma opção de venda dá ao titular o direito de vender o ativo subjacente até uma determinada data por um determinado preço. Alguns termos importantes para o melhor entendimento deste Capítulo são: “Ativo subjacente”, que é o ativo negociado no contrato, “data de vencimento”, no caso do modelo americano é até a data limite para exercer a opção de compra e no modelo europeu é na data final em que a opção de compra pode ou não ser exercida (serão discutidos mais detalhes sobre estas modalidades posteriormente) e “preço de exercício” (strike), é o valor a ser pago pelo ativo de acordo com o contrato. As opções americanas podem ser exercidas a qualquer momento até a data de vencimento. Por sua vez, as opções europeias podem ser exercidas somente na própria data de vencimento. As opções europeias são geralmente mais fáceis de analisar do que as opções americanas, e algumas das propriedades de uma opção americana são frequentemente deduzidas daquelas de sua contraparte europeia. A opção de compra (call) dá ao comprador da opção o direito de comprar o ativo subjacente pelo preço de exercício. A opção de venda (put) dá ao comprador da opção o direito de vender o ativo subjacente pelo preço combinado no contrato na data futura. O preço de uma opção de compra diminui à medida que o preço de exercício aumenta, enquanto o preço de uma opção de venda aumenta à medida que o preço de exercício aumenta. Ambos os tipos de opção tendem a se tornar mais valiosas à medida que seu tempo até o vencimento aumenta. Na verdade existem seis fatores que afetam o preço de uma opção de ação, por exemplo: O preço atual da ação, \\(S_0\\) O preço de exercício, \\(K\\) O tempo para expiração, \\(\\tau\\) A volatilidade do preço das ações, \\(\\sigma\\) A taxa de juros livre de risco, \\(r\\) Os dividendos que se espera sejam pagos, \\(q\\) Observamos que existem quatro tipos de participantes nos mercados de opções: Compradores de calls Vendedores de calls Compradores de puts Vendedores de puts Os compradores são referidos como tendo posições long, vendedores são referidos como tendo posições short. Vender uma opção também é conhecido como lançar a opção ou subscrever. Exemplificando uma operação de compra de call, caso o preço do ativo tenha subido acima do preço de strike o comprador pode exercer sua opção de compra e ele lucrará a partir do momento em que o valor da ação for maior que o strike mais o valor pago pela opção (chamado de prêmio). Caso o preço do ativo tenha caído abaixo do strike, o comprador simplesmente não exerce sua opção, limitando sua perda nessa operação ao prêmio pago. Tabela 1.1: Exemplo: Comprando call de X com o preço de exercício (strike) de 10.000 Ação Prêmio Pago Opção no Exercício Lucro Moneyness 9000 200 0 -200 OTM 9500 200 0 -200 OTM 10000 200 0 -200 ATM 10200 200 200 0 ITM 10500 200 500 300 ITM 11000 200 1000 800 ITM Usando a tabela 1.1 como exemplo é possível ver que o resultado final será maior que R$ 0 quando o valor do ativo subjacente é maior que R$10.200 (R$10.000 de strike + R$200 de prêmio), e o prejuízo final está limitado ao valor de R$200. A figura 1.1 abaixo mostra o perfil de lucro da operação exemplificada, típico de uma compra de call. Figura 1.1: Perfil de lucro típico de uma compra de call. No caso de uma operação de uma compra de put, caso o preço do ativo tenha subido acima do strike, não faz sentindo o detentor da opção exercer seu direito, assim sua perda será apenas o valor pago pela opção. Caso o preço do ativo tenha descido abaixo do strike, o comprador da put pode realizar a venda e começará a lucrar a partir do momento em que o strike fique acima do valor do ativo somado ao valor do prêmio pago pela opção. Usando a tabela 1.2 como exemplo é possível ver que o resultado final será de no mínimo -R$600 caso o valor do ativo subjacente seja igual ou maior que R$15.000, e o resultado final aumenta conforme o ativo perde o valor, sendo positivo a partir de quando seu valor é de R$14.400. 1.1 Conceitos in the money, at the money e out the money Estes termos são usados para se referir a opções que estão com o preço de exercício (strike) do ativo abaixo, acima ou igual ao valor atual do ativo. Out the money: Strike do ativo subjacente está abaixo do valor de mercado no caso de calls ou quando o strike do ativo está acima do valor de mercado no caso de puts. At the money: Strike do ativo subjacente é o igual ao valor de mercado. In the money: Strike do ativo subjacente está acima do valor de mercado no caso de calls ou quando o strike do ativo está abaixo do valor de mercado no caso de puts. 1.2 Modelos americano e europeu de opções No modelo americano de opções o comprador pode exercer seu direito de compra ou venda do ativo subjacente a qualquer momento entre o início do contrato e o vencimento dele, enquanto isso no modelo europeu a transação só pode ser realizada na data de vencimento. 1.3 Hedge O mercado de opções pode ser usado tanto para hedge (proteção) quanto para especulação. O hedge é feito para limitar as possíveis perdas que um investidor pode ter ao estar com seu patrimônio atrelado a determinado ativo, por exemplo, para um acionista que possui ações de determinada empresa se proteger contra uma possível queda no valor de suas ações, ele pode comprar opções de venda at the money de suas ações para que seu prejuízo máximo seja o prêmio. 1.4 Travas Devido ao mercado de opções nos oferecer diversas possibilidades entre call e put onde você pode estar comprado e/ou vendido irá surgir várias posições a serem assumidas, para nos adequarmos ao quanto estamos dispostos a encarar o risco parar atingirmos o retorno desejado. Essas posições são conhecidas como “Travas”. Entendendo as travas, existem diversas estratégias, como por exemplo: Trava de alta, trava de baixa, Long Straddle, Short Straddle, entre outras. Mas afinal qual é o funcionamento delas? Supondo que o leitor espere uma alta do mercado, no entanto acredite que não irá superar determinado ponto ele poderá realizar uma Trava de alta. Onde comprará uma opção de Call a um preço de strike X e vender outra Call com o preço de strike Y, onde obrigatoriamente Y&gt;X. Nesta operação limitaremos o nosso ganho caso o mercado supere as nossas expectativas, no entanto diminuiremos o custo da operação, o custo será o prêmio pago pela opção X menos o prêmio recebido pela opção Y, para facilitar a compreensão observemos o gráfico a seguir: Nesse caso o valor do prêmio da compra foi de R$30,00 enquanto a da venda foi R$10,00, assim limitamos nossa perda em R$20,00, enquanto os preços de strike da compra e da venda da call foram respectivamente R$250,00 e R$300,00, fazendo o retorno máximo ser R$30,00 que é a diferença entre os valores de strike a serem realizados e descontado o valor pago pelo prêmio. Agora que o leitor já entendeu melhor o conceito da trava, vamos explorar uma mais complexa a Long Butterfly. Aqui é realizado a compra de uma put e call com preços de strike iguais, vendesse uma put com preço inferior e vende alguma call com preço superior as iniciais. Observe que pelo fato de contar com a venda de duas opções nessa estratégia tem um custo de operação reduzido, no entanto o ideal é utilizar em um mercado de pouca volatilidade, dado que se a volatilidade ser alta perdesse a possibilidade de ter um ganho maior, nesse caso recomenda o uso por exemplo de uma Long Straddle. Enfim vamos ao gráfico para facilitar a compreensão da estratégia: Teremos então a compra de uma put e call de strike iguais de R$150,00 a venda de uma put com strike inferior de R$80, e a venda de uma call com preço superior R$220. Os valores exatos dos prêmios não nos interessam no momento, porém é importante entender que teremos dois com saldos positivos referente a nossa venda e dois negativos que advém das compras, o resultado será nosso prejuízo máximo, olhando o gráfico nesse caso é de R$20,00. Pela área de retorno do gráfico podemos ver que nosso risco está reduzido. Onde o pior cenário possível se encontra em o preço do ativo-objeto se aproximar do valor do R$150,00, que é onde os contratos adquiridos não serão vantajosos em nenhuma ponta. No entanto se o preço se aproximar de R$220 poderemos exercer nosso direito da compra da call inicial por R$150,00(você terá o direito de comprar a um preço inferior), o mesmo será valido caso haja uma queda do preço se aproximado do valor de R$80,00 onde a logica será a mesma só que aqui será o usado o direito da compra da put por R$150,00(Você terá o direito de vender a um preço superior). Observe que apesar do nosso risco ser reduzido, limita os nossos ganhos, com a venda da call e da put com preços superior e inferior respectivamente. Espero que o leitor tenha despertado interesse no assunto, com esse conteúdo dominado já saberá o básico sobre opções, fique atento a novas postagens em breve iremos mais a afundo explicando por exemplo o modelo Black Scholes, como as opções são precificadas entre outros materiais. Artigo originalmente escrito por Glauber Naue e Erik Kawano, adaptado por Rafael Bressan para este livro.↩ "],
["processos-estocasticos.html", "Capítulo 2 Processos Estocásticos em Finanças 2.1 Processos de Markov 2.2 Movimento Browniano 2.3 Definição 2.4 Movimento Browniano Geométrico", " Capítulo 2 Processos Estocásticos em Finanças Neste artigo abordaremos um assunto técnico, mas muito utilizado e de fudamental importância para a precificação de instrumentos derivativos. Será apresentado o conceito de processos estocásticos - PE, e sua aplicação no mundo das finanças. Um processo estocástico é a evolução temporal de uma determinada variável de interesse que pode assumir valores aleatórios em cada ponto no tempo. Em outras palavras, o caminho que a variável segue ao longo do tempo evolui de maneira incerta. Estes processos podem se dar em tempo discreto ou em tempo contínuo. Processo em tempo discreto são aqueles onde o valor da variável pode se alterar somente em intervalos pré-definidos de tempo, por exemplo ao final do dia. Em processos em tempo contínuo, o valor de nossa variável está constantemente em mudança, de forma aleatória seguindo alguma distribuição de probabilidades. Estes processos são muito importantes em finanças pois, é amplamente aceito que a evolução do preço de ativos financeiros pode ser modelado por um PE em tempo contínuo, sendo este modelo portanto, a base para a teoria de precificação de ativos e da qual os derivativos fazem extenso uso. Aprender sobre a evolução temporal do preço de uma ação através de um processo estocástico é o primeiro passo para saber como atribuir um preço a uma opção sobre esta ação, por exemplo. Deve ser notado também que apesar de o preço dos ativos serem observados apenas em intervalos discretos de tempo (apenas quando existe transação) e assumirem valores também discretos (múltiplos de um centavo), o preço e sua evolução estão ocorrendo continuamente, nossas observações que são discretas. Desta forma os processos em tempo contínuos são ideais para este tipo de modelagem. 2.1 Processos de Markov Uma primeira definição de deve-se fazer para estudar PE aplicados a evolução do preço de ações é o conceito de processo de Markov. Este tipo de processo é tal que o histórico do processo que o levou até seu estado atual, é irrelevante para a previsão de seu estado futuro. Ou seja, toda a informação da história do processo já está contida no seu valor atual. Quando consideramos que preços de ativos seguem um processo de Markov, estamos assumindo válida pelo menos a forma fraca de mercados eficientes. Uma implicação desta suposição, verificada empiricamente, é que não se pode obter lucros apenas seguindo padrões históricos do preço e extrapolando-os no futuro. Outra, mais importante para nossos processos, é que as distribuições de probabilidade que a variável aleatória segue em cada ponto no tempo são independentes. 2.2 Movimento Browniano Suponha um processo de Markov, que para fins de simplificação consideraremos em tempo discretos. Se a distribuição de probabilidade para o próximo incremento no valor do processo for uma Normal com média zero e variância unitária, podemos representar este incremento por \\(\\phi(0, 1)\\). Como este é um processo de Markov, o segundo incremento será independente do primeiro e terá novamente a mesma distribuição de probabilidade. Qual seria então, a partir do período inicial até o segundo período, a distribuição de probabilidade dos possíveis valores de nosso hipotético processo? A reposta é a soma de duas normais \\(\\phi(0, 1)\\) que resulta em \\(\\phi(0, 2)\\). Se assim continuarmos a fazer previsões para T períodos a frente, nossa distribuição terá densidade \\(\\phi(0, T)\\). Para tempos discretos, \\(T\\in\\mathbb{Z}\\) este é o processo do passeio aleatório (Random Walk), entretanto para tempo contínuo quando \\(T\\in\\mathbb{R}\\) com incrementos acontecendo em intervalos de tempo infinitesimalmente pequenos, este é o Movimento Browniano - MB, que também é largamente conhecido como processo de Wiener. t &lt;- 0:500 m &lt;- 5 # Numero de simulacoes mc_names &lt;- paste0(&quot;Sim&quot;, seq_len(m)) # Nomes das simulacoes sigma2 &lt;- 1 mu &lt;- 0 brown_t &lt;- matrix(nrow = length(t), ncol = m) # MC Simulation set.seed(543210) for (i in seq_len(m)) { increments &lt;- rnorm(length(t) - 1, mu, sqrt(sigma2)) brown_t[, i] &lt;- c(0, cumsum(increments)) } colnames(brown_t) &lt;- mc_names mb &lt;- as.tibble(cbind(t, brown_t)) %&gt;% gather(key = sim, value = value, -t) ## Warning: `as.tibble()` is deprecated, use `as_tibble()` (but mind the new semantics). ## This warning is displayed once per session. ggplot(mb, aes(x = t, y = value, color = sim)) + geom_line() + # geom_point(data = dens_tbl, aes(x = x, y = y), size = 1) + labs(title = &quot;5 realizações Movimento Browniano&quot;, x = &quot;Tempo&quot;, y = &quot;Valor&quot;) + guides(color = FALSE) + scale_color_viridis_d() + theme_economist_white() A figura acima mostra 5 realizações de um mesmo processo estocástico com média zero e variância unitária. É importante frisar que o processo que gerou as cinco séries é exatamente o mesmo, sendo elas tão distintas umas das outras ou não. Esta é uma importante característica dos processos estocásticos nas aplicações reais, o que nós observamos é apenas uma realização do processo, dentre as infinitas possíveis. 2.3 Definição Agora que já foi passada a intuição sobre processos estocásticos, pode-se partir para definições mais formais sobre estes processos. Vamos adotar a notação do cálculo para tanto, e generalizar nosso MB possibilitando-o que tenha média diferente de zero (\\(\\mu\\)) e variância qualquer (\\(\\sigma^2\\)), mantendo estas constantes ao longo do tempo, entretanto. Desta forma um movimento Browniano com deriva pode ser descrito através da seguinte equação diferencial estocástica - EDE: \\[\\begin{equation} dX_t = \\mu dt + \\sigma dB_t \\tag{2.1} \\end{equation}\\] onde \\(dB_t\\) é nosso MB padrão em um intervalo de tempo infinitesimal, \\(dt\\). O processo \\(X_t\\) possui uma taxa de deriva (média instantânea) igual a \\(\\mu\\) e volatilidade instantânea igual a \\(\\sigma\\). Quando um PE possui deriva igual a zero, como nosso MB padrão, o valor esperado deste processo para qualquer período futuro será zero. Este fato deixa de ser verdade no processo generalizado, com taxa de deriva diferente de zero. Neste caso o processo evoluirá seguindo uma taxa crescente (se \\(\\mu &gt; 0\\)) ou decrescente (se \\(\\mu &lt; 0\\)). Assim é possível, a partir de um MB padrão, modelar outros PE que possuam tendência temporal e variâncias diferentes. 2.4 Movimento Browniano Geométrico Apesar de o processo \\(X_t\\) ser bastante flexível e cobrir uma grande gama de usos, ele ainda não é adequado para modelar o preço de ativos, e isto se dá em função de o processo de Wiener, mesmo com deriva positiva, poder atingir valores negativos com probabilidade maior que zero. Isto implicaria na possibilidade do preço de uma ação ser negativo, algo que obviamente não ocorre. Além desta impossibilidade, existe um outro empecilho para se utilizar o MB para modelar o processo de preços, e este é a deriva constante \\(\\mu\\) com relação ao preço da ação. A deriva pode ser interpretada como o valor esperado do retorno da ação em um dado período de tempo. Este retorno esperado ele é pode ser constante em termos percentuais (em um modelo simplificado), mas não em termos absolutos! Ou seja, dependendo do preço da ação, R$ 1,00 ou R$ 100,00, a deriva \\(\\mu\\) deve ser diferente para que em termos percentuais a relação seja constante. A solução para estes dois problemas é modelar o preço como um processo estocástico conhecido como Movimento Browniano Geométrico. Ele difere do MB padrão pois assume que o logaritmo da variável aleatória possui distribuição Normal. O MBG é a resolução para a seguinte EDE: \\[\\begin{equation} dX_t = \\mu X_t dt + \\sigma X_t dB_t \\tag{2.2} \\end{equation}\\] Veja que este é basicamente o mesmo processo MB, porém a deriva, termo que multiplica \\(dt\\), varia linearmente com o valor do processo (\\(\\mu X_t\\)) assim como a volatilidade instantânea (\\(\\sigma X_t\\)). A solução para esta EDE, para um valor inicial qualquer de \\(X\\) (\\(X_0 &gt; 0\\)) é dada por: \\[\\begin{equation} X_t = X_0\\exp\\left(\\left(\\mu-\\frac{\\sigma^2}{2}\\right)t+\\sigma B_t\\right) \\tag{2.3} \\end{equation}\\] A variável aleatória \\(X\\) segue um MB ao longo de uma trajetória exponencial. É fácil verificar que, por ser exponencial, \\(X_t\\) nunca terá valor negativo. Esta é uma forma conveniente de representar a evolução de preços de um ativo pois naturalmente surge o conceito de retornos logarítmos. O log-retorno de \\(X\\) é dado por \\(r_t=\\ln(X_t/X_0)\\) de onde inferimos que se o processo de formação de preço de um ativo segue um MBG, então seus log-retornos serão normalmente distribuídos com média \\(\\mu-\\frac{\\sigma^2}{2}\\) e volatilidade \\(\\sigma\\) em uma unidade de período considerado. Se escalarmos o período de tempo considerado para \\(T\\), temos então que os retornos logarítmicos do ativo \\(X\\) seguem a seguinte distribuição normal: \\[\\begin{equation} r_T \\sim\\phi\\left(\\left(\\mu-\\frac{\\sigma^2}{2}\\right)T, \\sigma^2T\\right) \\tag{2.4} \\end{equation}\\] Abaixo apresentamos 5 realizações de um MBG com valor de deriva \\(\\mu = 0,6\\% a.p.\\) e variância \\(\\sigma^2=1\\% a.p.\\). t &lt;- 0:500 m &lt;- 5 # Numero de simulacoes mc_names &lt;- paste0(&quot;Sim&quot;, seq_len(m)) # Nomes das simulacoes sigma2 &lt;- 0.01 mu &lt;- 0.006 # c(0.098, 0.099, 0.1, 0.101, 0.102) / 10 brown_t &lt;- matrix(nrow = length(t), ncol = m) # MC Simulation set.seed(1234567) for (i in seq_len(m)) { log_ret &lt;- rnorm(length(t) - 1, mu - (sigma2 / 2), sqrt(sigma2)) brown_t[, i] &lt;- c(1, cumprod(exp(log_ret))) } colnames(brown_t) &lt;- mc_names mb &lt;- as.tibble(cbind(t, brown_t)) %&gt;% gather(key = sim, value = value, -t) ggplot(mb, aes(x = t, y = value, color = sim)) + geom_line() + labs(title = &quot;5 realizações Movimento Browniano Geométrico&quot;, x = &quot;Tempo&quot;, y = &quot;Valor&quot;) + guides(color = FALSE) + scale_y_continuous(breaks = 0:10) + scale_color_viridis_d() + theme_economist_white() O Movimento Browniano Geométrico aqui demonstrado serve de base para o famoso modelo Black &amp; Scholes de precificação de opções, o qual assume que o ativo subjacente à opção (por exemplo, a ação de uma empresa) tem seu preço formado por um processo MBG. "],
["bsm.html", "Capítulo 3 Modelo Black-Scholes-Merton 3.1 Portfólio de replicação 3.2 Precificação neutra ao risco 3.3 Encontrando a equação de Black-Scholes 3.4 Solução analítica 3.5 Paridade compra e venda 3.6 As Gregas", " Capítulo 3 Modelo Black-Scholes-Merton Neste artigo desenvolveremos o modelo para precificação de opções do tipo europeias proposto Black and Scholes (1973) e posteriormente expandido por Merton (1976). A derivação deste modelo se baseia nos conceitos apresentados sobre processos estocásticos do Capítulo 2. Antes de entrar na modelagem desenvolvida pelos autores acima citados, iremos tratar de algumas definições essenciais, como por exemplo a precificação de ativos em um mundo neutro ao risco (risk neutral valuation) e portfólio de replicação (replicating portfolio), que são largamente utilizados na precificação de quaisquer derivativos, e não somente opções. 3.1 Portfólio de replicação Suponha que se deseja precificar uma opção de compra sobre uma ação, vamos denotar o preço desta call de \\(f_t\\). Sabemos que na data de expiração, \\(T\\), da opção de compra seu preço será: \\(f_T=max(S_T - K, 0)\\), onde \\(S_T\\) é o preço da ação subjacente na data \\(T\\) e \\(K\\) é o preço de exercício da opção. Podemos criar um portfólio que envolva um ativo livre de risco, com preço \\(B_t\\) e a ação objeto do derivativo, \\(S_t\\), que recrie o mesmo valor de pagamento que a opção na data de expiração. Ou seja, criamos o portfólio de replicação \\(P_t=\\Delta S_t + b B_t\\), no qual devemos escolher os valores de \\(\\Delta\\) e \\(b\\) de tal forma que \\(f_T = P_T\\). De fato, para apenas um período a frente, podemos tomar emprestado a taxa de juros livre de risco2, \\(r\\) um valor igual ao preço corrente da ação, \\(S_0\\) e comprá-la, ao mesmo tempo em que se “trava” (faz hedge) deste portfólio vendendo a opção. O lucro desta operação em \\(T\\) deve ser zero, pois é um portfólio travado. Com estas premissas é possível calcular o preço do prêmio da opção a ser cobrado no período inicial para que o valor esperado da operação como um todo seja zero. Este portfólio formado pela venda do ativo livre de risco e compra do ativo objeto é denominado portfólio de replicação, pois, ele fornece um fluxo de caixa igual ao derivativo que buscamos precificar. Ao adicionarmos ao portfólio de replicação a venda (ou seja, o negativo) do derivativo, temos um portfólio hedgeado, onde não existe mais incerteza com relação ao seu retorno esperado. 3.2 Precificação neutra ao risco A metodologia de precificação de derivativos dentro do mundo neutro ao risco3 é o carro-chefe das metodologias para se avaliar estes instrumentos. O princípio de precificação neutra ao risco afirma que um derivativo pode ser valorado através das seguintes suposições: o retorno esperado do ativo objeto é a taxa livre de risco, e o valor esperado do derivativo na expiração deve ser descontado pela taxa livre de risco para trazê-lo a valor presente. É claro que o mundo real não é neutro ao risco, entretanto uma das provas que a metodologia faz é que, ao precificarmos um derivativo de forma relativa ao preço do ativo objeto, a precificação neutra ao risco encontra o mesmo valor para o derivativo que uma metodologia que leve em conta as preferências ao risco dos investidores. Entretanto, precificar um derivativo assumindo neutralidade ao risco é muito mais simples que encarar um modelo baseado no mundo real. De fato a neutralidade ao risco soa um tanto quanto estranha a primeira vez. Porém, ela tem uma explicação lógica de sua validade nas circunstâncias em que é desenvolvida. Se os investidores forem avessos ao risco, por exemplo, os retornos esperados para o ativo objeto terão embutidos um prêmio pelo risco. Acontece que este prêmio pelo risco também deverá estar na taxa de desconto do valor esperado de pagamento do derivativo, de forma que este prêmio ao risco é cancelado. É comum na literatura de derivativos encontrarmos os termos mundo-P e mundo-Q. O mundo-P se refere ao mundo real, com probabilidades P reais de ocorrência de eventos, equanto que o mundo-Q é o mundo neutro ao risco, onde as probabilidades Q são ajustadas (tecnicamente suas medidas são alteradas) para refletir esta neutralidade. No mundo-Q é comum denotarmos o valor esperado de alguma variável aleatória com a seguinte notação: \\(\\mathbb{E_Q}[\\cdot]\\). Assim, a precificação de derivativos supondo um mundo neutro ao risco chega no preço correto para todos os mundos. 3.3 Encontrando a equação de Black-Scholes Vamos partir do princípio que nossa ação, objeto da opção que desejamos precificar, siga um MBG conforme descrito no capítulo anterior. Portanto, o preço de nossa ação no período \\(t\\) deve observar a seguinte equação diferencial estocástica: \\[\\begin{equation} dS_t=\\mu S_t+\\sigma S_t dW_t \\tag{3.1} \\end{equation}\\] onde \\(dW_t\\) é o movimento Browniano, ou processo de Wiener. Esta equação resume as principais hipóteses do modelo Black&amp;Scholes de precificação de opções, são elas: O preço do ativo objeto é um processo estocástico e segue uma distribuição log-normal; O retorno esperado (\\(\\mu\\)) e a volatilidade (\\(\\sigma\\)) deste ativo são constantes, tanto no tempo quanto com relação ao próprio nível de preço do ativo objeto. Ademais destas hipóteses, temos aquelas relacionadas a racionalidade dos mercados e ao princípio de ausência de oportunidades de arbitragem. Estas hipóteses nos levam a validade do mundo neutro ao risco e portanto, a resolução do modelo da forma como descreveremos abaixo. Nossa opção será descrita por um portfólio de replicação, e se tomarmos seu preço no instante \\(t\\), então a opção também deve seguir uma equação diferencial estocástica da forma: \\[\\begin{equation} df_t=\\Delta dS_t+b\\,dB_t \\tag{3.2} \\end{equation}\\] aqui \\(dB_t\\) representa a variação do ativo livre de risco (dinheiro) dentro de um período de tempo \\(dt\\). Sabemos que o valor do ativo livre de risco não envolve incerteza alguma, é determinístico, e seu rendimento é a taxa de juros livre de risco. Assim, para uma taxa continuamente composta \\(r\\) uma unidade de \\(B\\) evolui através de \\(B_t=e^{rt}\\), logo: \\[\\begin{equation} dB_t=rBdt \\tag{3.3} \\end{equation}\\] De acordo com o lema de Ito o diferencial de uma função que dependa do tempo e de um processo estocástico pode ser encontrado da seguinte forma: \\[\\begin{equation} df_t=\\frac{\\partial f}{\\partial t}dt + \\frac{\\partial f}{\\partial S}dS + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial S^2}dS^2 \\tag{3.4} \\end{equation}\\] onde \\(dS^2\\) é a variação quadrática de nosso processo \\(S_t\\) que é um movimento browniano geométrico, logo \\(dS^2=\\sigma^2S^2dt\\). Igualando as equações (3.2) e (3.4), fazendo as devidas substituições trazidas pelas equações (3.1) e (3.3) e por fim rearranjando os termos, chegamos na seguinte relação: \\[\\begin{equation} \\left( \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial S}\\mu S + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial S^2}\\sigma^2 S^2 - \\Delta\\mu S - rbB \\right)dt + \\left( \\frac{\\partial f}{\\partial S}\\sigma S - \\Delta \\sigma S \\right)dW = 0 \\end{equation}\\] que para ser válida para todo \\(t\\), cada termo entre parênteses deve ser igual a zero simultaneamente. Rapidamente chegamos aos valores necessários de nosso portfólio de replicação. \\[\\begin{equation} \\Delta = \\frac{\\partial f}{\\partial S} \\tag{3.5} \\end{equation}\\] \\[\\begin{equation} rbB = \\frac{\\partial f}{\\partial t}+\\frac{1}{2}\\frac{\\partial^2 f}{\\partial S^2}\\sigma^2S^2 \\tag{3.6} \\end{equation}\\] Através da equação (3.2), integrando-a, chegamos na relação \\(bB = f - \\Delta S\\) e pré-multiplicando ambos os lados por \\(r\\) temos então que: \\[\\begin{equation} rbB = r(f-\\Delta S) \\tag{3.7} \\end{equation}\\] Finalmente, igualando as equações (3.6) e (3.7) e substituindo o valor de \\(\\Delta\\) encontramos a famigerada equação diferencial parcial - EDP - de Black&amp;Scholes: \\[\\begin{equation} \\frac{\\partial f}{\\partial t}+\\frac{1}{2}\\sigma^2S^2\\frac{\\partial^2 f}{\\partial S^2}+rS\\frac{\\partial f}{\\partial S} - rf = 0 \\tag{3.8} \\end{equation}\\] 3.4 Solução analítica A equação possui diferentes formas de resolução4, a precificação do derivativo irá depender da forma que resolvermos a equação (3.8). O Modelo Black&amp;Scholes é famoso por conseguir precificar opções call e put europeias, onde a resolução da equação fará uso dos payoffs. Para uma call: \\[\\begin{equation} \\displaystyle f(S,T)=\\max(S-K,0) \\tag{3.9} \\end{equation}\\] Já no caso de uma put: \\[\\begin{equation} \\displaystyle f(S,T)=\\max(K-S,0) \\tag{3.10} \\end{equation}\\] Onde: T é a data de vencimento da opção, K é o preço de exercício, e S é o preço do ativo subjacente. Utilizando os payoffs dados nas equações (3.9) e (3.10), e resolvendo a EDP de Black&amp;Scholes (3.8), iremos obter o modelo para se precificar os derivativos citados. Para uma Call temos que: \\[\\begin{equation} C(S,t)=SN(d_{1})-Ke^{-r(T-t)}N(d_{2}) \\tag{3.11} \\end{equation}\\] Já para um Put chegamos a: \\[\\begin{equation} P(S,t)=Ke^{-r(T-t)}N(-d_{2})-SN(-d_{1}) \\tag{3.12} \\end{equation}\\] onde: \\[\\begin{equation}d_{1}={\\frac {\\ln(S/K)+(r+\\sigma ^{2}/2)(T-t)}{\\sigma {\\sqrt {T-t}}}} \\tag{3.13} \\end{equation}\\] \\[\\begin{equation}d_{2}={\\frac {\\ln(S/K)+(r-\\sigma ^{2}/2)(T-t)}{\\sigma {\\sqrt {T-t}}}}=d_1-\\sigma\\sqrt{T-t} \\tag{3.14} \\end{equation}\\] É a partir das equações (3.11) e (3.12) que se obtém as chamadas gregas, que são as sensibilidades do preço do derivativo em relação a alterações nos parâmetros do modelo. Explicaremos as gregas em maiores detalhes mais adiante. 3.5 Paridade compra e venda Agora vamos falar um pouco sobre a paridade entre opções de compra e venda, algo que nos ajuda a precificar algum derivativo quando já conhecemos o preço de outro derivativo com especificações semelhantes. Assumindo ausência de oportunidade de arbitragem, com um ativo subjacente que tenha liquidez, iremos verificar a paridade Call-Put que define uma relação entre os preços de uma call e put do tipo europeu, desde que possuam o mesmo tempo de maturidade e preço de strike. Aqui possuiremos menos premissas que o modelo Black&amp;Scholes e premissas mais simples, tal relação poderá ser utilizada para encontrar o valor justo de uma opção. Com a ausência de arbitragem observe que dois portfolios que sempre geram o mesmo payoff em um instante T devem ter o mesmo valor em qualquer instante intermediário. Imagine um primeiro portfólio onde o investidor compre uma opção de compra C, a qual possui tempo de maturidade T e preço de strike K, sobre algum ativo subjacente que chamaremos de S e compre um título B que seu valor no período T seja de $30. E um segundo portfolio onde tenha o próprio ativo subjacente S que esteja sendo negociado a $25 e compre uma put P com um preço de strike K e maturidade T. Estes são porfólios de replicação entre si, eles terão exatamente o mesmo payoff no período T, e na ausência de arbitragem, podemos calcular seus retornos através da precificação neutra ao risco. Teremos uma relação onde os valores dos nossos portfolios serão: \\[\\begin{equation} \\mathbb{E_Q}[S_t + P_t] = \\mathbb{E_Q}[C_t + B_t]; \\quad t \\leq T \\tag{3.15} \\end{equation}\\] Como estamos em um mundo neutro ao risco, \\(P_t\\) e \\(C_t\\) são os preços da put e da call dados pelo modelo B&amp;S, enquanto \\(\\mathbb{E_Q}[B_t]\\) se resume a \\(Ke^{-r(T-t)}\\), ou seja, a posição atual em ativo livre de risco deve ser o valor presente do strike das opções. O preço do subjacente é o próprio preço atualmente observado. Como \\(S_t\\) e \\(B_t=Ke^{-r(T-t)}\\) são conhecidos, se no mercado existir um preço \\(C_t\\) então podemos calcular \\(P_t\\) e vice-versa. Esta é a essência da paridade compra e venda. Observe que se essa relação não for mantida, teremos arbitragem: Suponhamos que \\(S_t &gt; B_t\\) e que a put esteja com um premio mais alto que a call no entanto ambos possuem um preço de strike $30 e maturidade T, que os prêmios sejam $20 e $15 respectivamente teremos então: 30 + 20 = 15 + 25, nesse caso teremos 50 \\(\\neq\\) 40, então vende-se o que está mais caro, no caso a ação e a put e compraria o título e a call, chegando ao um lucro de 50-40=10, de $10 sem risco. Observe que independentemente de a ação subir acima ou cair abaixo do strike, o lucro obtido nesta operação será sempre de $10. 3.6 As Gregas As letras gregas utilizadas no mercado de opções são usadas para denotar as sensibilidades do preço da opção com relação a variação de alguma das variáveis do modelo, a seguir entraremos em detalhes sobre as principais gregas usadas para a análise de opções. 3.6.1 Delta Já havíamos definido o delta anteriormente ao encontrarmos a EDP de Black&amp;Scholes, isto é: \\[\\begin{equation} \\Delta = \\frac{\\partial f}{\\partial S} \\tag{3.5} \\end{equation}\\] O delta mede a taxa com que o preço da opção muda conforme o valor do ativo subjacente oscila, seu valor pode variar entre 1 e 0 para call e entre 0 e -1 para put. Exemplo: imagine uma opção de compra de 100 ações que possui um delta de 0,72, caso o ativo subjacente aumente $1 o valor da opção aumentará $72 (pois representa 100 ações), e caso o valor do ativo subjacente diminua o preço da opção diminuirá $72. O mesmo acontece com opções de venda, só que de uma forma inversamente proporcional pelo seu delta ser negativo. Uma opção de venda de 100 ações que possui um delta de -0,40 vai valer menos $40 caso o preço do seu ativo subjacente aumente $1, e vai valer mais $40 caso o preço do seu ativo subjacente diminua $1. O strike da opção influência o delta diretamente, quanto mais in-the-money for uma opção, call ou put, maior será o seu delta em valor absoluto, e quanto mais out-the-money, menor será o módulo de seu delta. 3.6.2 Gamma \\[\\begin{equation} \\Gamma = \\frac{\\partial \\Delta}{\\partial S} = \\frac{\\partial^2 f}{\\partial S^2} \\tag{3.16} \\end{equation}\\] O gamma mede a taxa com que o delta muda a cada oscilação do preço do ativo subjacente, seu impacto aumenta conforme o valor atual do ativo se aproxima do strike, sendo responsável pela convexidade do valor da opção. Opções de alto gamma são chamadas de explosivas, uma vez que mesmo pequenas variações no preço do ativo se traduzem em grandes oscilações no preço da opção. 3.6.3 Theta \\[\\begin{equation} \\Theta = -\\frac{\\partial f}{\\partial \\tau}, \\quad \\tau=T-t \\tag{3.17} \\end{equation}\\] O Theta é uma taxa que mede o efeito do tempo sobre o preço da opção. Como as opções tem um maior valor de acordo com a quantidade de tempo até a data de vencimento, seu valor também diminui conforme o tempo passa, theta é a letra que mede essa variação (que sempre é negativa). O valor de theta representa a quantidade de dinheiro perdida no prêmio da opção a cada dia que passa. 3.6.4 Vega \\[\\begin{equation} \\displaystyle {\\mathcal {V}}=\\frac{\\partial f}{\\partial \\sigma} \\tag{3.18} \\end{equation}\\] O vega é uma taxa que mede o efeito da mudança da volatilidade no preço da opção. Seu valor é praticamente constante em opções com a mesma data de vencimento, esse valor aumenta em datas de vencimento mais distantes devido ao maior espaço de tempo em que a volatilidade atua, devido ao maior intervalo de tempo que há para ocorrer mudanças nos preços. 3.6.5 Rho \\[\\begin{equation} \\displaystyle \\rho =\\frac{\\partial f}{\\partial r} \\tag{3.19} \\end{equation}\\] O rho é uma taxa que mede a sensitividade do preço da ação em relação à taxa livre de risco, caso o valor de de rho determinada opção seja 0,7, para cada aumento de 1% da taxa livre de risco o valor da opção aumentará 0,7%. Essa taxa influi principalmente no preço de opções com uma data de vencimento extremamente distante, não afetando muito o preço de opções cuja data de vencimento é próxima. Bibliografia "],
["smile.html", "Capítulo 4 Smile de Volatilidade 4.1 Reparametrizando B&amp;S e definição de moneyness 4.2 Características de smiles de volatilidade 4.3 Smile como forma de precificação 4.4 Estrutura a termo 4.5 Arbitragem estática 4.6 Limites de inclinação 4.7 Distribuição implícita 4.8 Conclusão", " Capítulo 4 Smile de Volatilidade A volatilidade instantânea, \\(\\sigma\\), do ativo subjacente é a única variável no modelo B&amp;S que não pode ser diretamente observada. De fato, a volatilidade (ou equivalentemente a variância) de um ativo é dita uma variável latente. Sabemos que ela existe e possui algum valor no processo gerador, o processo pelo qual os preços são formados, porém não conseguimos observá-la diretamente, apenas estimá-la. Uma das formas de estimação de volatilidade pode ser a partir de dados históricos, mas várias outras formas existem, entre elas processos GARCH, volatilidade realizada, volatilidade estocástica, etc. Uma vez que a volatilidade não pode ser diretamente observada, a prática comum no mercado é fazer o caminho inverso. Considerar os preços de mercado para as opções como dado, e a partir do modelo B&amp;S inverter a equação de preço da Call ou Put para encontrar a volatilidade deste modelo que é compatível com os preços de mercado. A esta volatilidade encontrada damos o nome de volatilidade implícita. Portanto, o smile de volatilidade que tratamos neste post é na verdade um gráfico entre a volatilidade implícita, retirada de opções Européias (baunilhas, do inglês vanilla options) a partir do modelo B&amp;S, contra os strikes destas opções. 4.1 Reparametrizando B&amp;S e definição de moneyness Nem sempre é interessante plotar o smile contra os strikes propriamente ditos, uma forma de avaliar o quanto uma opção está “dentro, fora ou no dinheiro” pode ser a grega Delta ou então o chamado moneyness (por favor, se alguém tiver uma boa tradução para este termo, deixe nos comentários). Tradicionalmente a medida de moneyness é a relação \\(K/S\\), ou seja o strike contra o preço corrente do subjacente. Porém existem outras definições mais interessantes para se trabalhar, entretanto, antes devemos fazer uso de algumas definições e vamos reparametrizar as expressões \\(d1\\) e \\(d2\\) do modelo B&amp;S. Lembrando que em precificação de opções estamos no mundo neutro ao risco, vamos definir o valor forward, \\(F\\) do subjacente como o valor corrente composto pela taxa livre de risco até a maturidade da opção, ou seja: \\[\\begin{equation} F=e^{r\\tau}S \\end{equation}\\] A volatilidade (implícita) total pode ser definida como a volatiliade reescalada pela raiz do tempo, que nos dá uma informação da volatiliade esperada para o subjacente do período corrente até a maturidade. Da mesma forma, a variância total. Denotanto a volatilidade total por \\(\\theta\\) e a variância total por \\(w\\), temos: \\[\\begin{equation} \\theta=\\sigma_{imp}\\cdot \\sqrt{\\tau} \\tag{4.1} \\end{equation}\\] e \\[\\begin{equation} w=\\sigma_{imp}^2\\cdot\\tau \\tag{4.2} \\end{equation}\\] Vamos também definir a medida forward log-moneyness e denotá-la por \\(k\\). Esta será a medida de moneyness que iremos utilizar ao longo deste e de outros artigo, portanto iremos utilizar este termo para designar o forward log-moneyness a não ser que expresso de forma contrária no texto. \\[\\begin{equation} k=\\ln\\left(\\frac{K}{S}\\right)-r\\tau=\\ln\\left(\\frac{K}{F}\\right) \\tag{4.3} \\end{equation}\\] Logo, o strike está relacionado ao moneyness de forma que: \\(K=Fe^k\\). Podemos agora reparametrizar as expressões \\(d1\\) e \\(d2\\) do modelo B&amp;S de forma que serão mais facilmente trabalhadas em modelos de volatilidade. Lembrando destas expressões que já foram apresentadas no Capítulo 3: \\[\\begin{align} &amp;d_{1}={\\frac {\\ln(S/K)+(r+\\sigma ^{2}/2)(\\tau)}{\\sigma {\\sqrt {\\tau}}}}\\\\ &amp;d_{2}={\\frac {\\ln(S/K)+(r-\\sigma ^{2}/2)(\\tau)}{\\sigma {\\sqrt {\\tau}}}}=d_1-\\sigma\\sqrt{\\tau} \\end{align}\\] Substituindo as expressões para forward log-moneyness e volatilidade total nas definições acima temos as novas parametrizações para \\(d1\\) e \\(d2\\): \\[\\begin{equation} d_{1}={-\\frac{k}{\\theta}+\\frac{\\theta}{2}} \\tag{4.4} \\end{equation}\\] \\[\\begin{equation} d_{2}={-\\frac{k}{\\theta}-\\frac{\\theta}{2}}=d_1-\\theta \\tag{4.5} \\end{equation}\\] Retomando o valor da opção do tipo Call no modelo B&amp;S, podemos reescrever sua fórmula de apreçamento da seguinte forma: \\[\\begin{equation} \\begin{aligned} C(K, \\tau)=&amp;SN(d1)-Ke^{-r\\tau}N(d2)\\\\ e^{r\\tau}C(K, \\tau)=&amp;FN(d1)-KN(d2)\\\\ C_B=&amp;F\\left[N(d1)-e^kN(d2)\\right] \\end{aligned} \\tag{4.6} \\end{equation}\\] Esta equação é conhecida como a forma de Black de precificação (Black Call price formula), que relaciona os valores forward da opção (também conhecido como valor não descontado), do subjacente e do strike. Esta formulação é particularmente útil quando formos extrair a distribuição neutra ao risco do subjacente que está implícita nos preços de mercado das opções. 4.2 Características de smiles de volatilidade Caso o modelo de Black, Schole e Merton estivesse em acordo com a realidade, e os ativos tivessem seus preços formados a partir de um verdadeiro MBG, a volatilidade implícita seria uma constante. O gráfico do smile de volatilidade seria uma reta horizontal, com a mesma volatilidade para qualquer nível de moneyness e se considerarmos a superfície toda (que leva em conta os diversos tempos para expiração) esta seria paralela ao domínio \\((k, \\tau)\\). Não estaríamos escrevendo (e você lendo) este artigo se este fosse o caso… O fato é que o modelo B&amp;S é um modelo muito restritivo, com inúmeras suposições que não se verificam no mundo real e que por conseguinte, tornam os resultados do modelo pouco acurados. Entretanto este é um modelo muito conhecido, de fácil assimilação por parte dos agentes de mercado e que virou a língua franca nos mercados de derivativos. Se todos os traders conversarem em termos do modelo B&amp;S, todos se entenderão, mesmo que internamente cada um possua seu próprio modelo de apreçamento. Entre as características tipicamente observadas em smiles (e superfícies) de volatilidades pode-se citar: As volatilidades implícitas variam conforme o strike e prazo de expiração Smiles apresentam skew. Maior inclinação em uma das asas, representando uma maior probabilidade daqueles strikes acontecerem Smiles de equity tipicamente são negativos Mercados diferentes apresentam padrões de smile diferentes 4.2.1 Mercados cambiais Opções sobre moedas possuem tipicamente um smile de volatilidade conforme mostrado na figura 4.1 abaixo. A volatilidade implícita é relativamente baixa para opções ATM. Esta torna-se progressivamente maior quando a opção se move para dentro do dinheiro ou para fora. Figura 4.1: Smile típico de um mercado cambial. Caso a distribuição dos preços do ativo subjacente, neste caso uma taxa de câmbio fosse perfeitamente log-normal como no modelo B&amp;S, o smile não teria esta curvatura. Desta forma podemos afirmar que o mercado, ao precificar as opções, acredita que a distribuição deste ativo possui caudas com maior densidade que supõe a log-normal, existem maiores probabilidades de retornos muito baixos ou muito altos. 4.2.2 Mercados de equities Nos mercados de equities, ações, índices de ações e ETFs, por exemplo, o smile apresenta uma característica de assimetria (skew, em inglês) negativa. A asa esquerda (parte onde as puts estão fora do dinheiro) apresenta valores de volatilidade implícita muito maiores que suas contrapartes no lado das calls. Este comportamento reflete a percepção de mercado de uma maior probabilidade de grandes perdas nas ações que altos ganhos, gerando portanto, uma distribuição de preços assimétrica. Como existe uma maior probabilidade de perdas extremas, o seguro para estas, ou seja, uma put é relativamente mais cara que uma call. Figura 4.2: Smile típico de uma ação ou índice de ações. 4.3 Smile como forma de precificação Analisando a equação de B&amp;S com a parametrização para \\(d1\\) e \\(d2\\) dada no início deste artigo é possível verificar que existe uma relação direta entre volatilidade implícita e preço de uma opção, seja esta uma call ou put. Como \\(d1\\) é estritamente crescente em \\(\\theta\\) e \\(d2\\) é estritamente decrescente e ao mesmo tempo o preço de uma opção é crescente em d1 e decrescente em d2, logo, temos uma relação direta entre o preço de uma opção e sua volatilidade implícita para uma dada maturidade. Em outras palavras, em um smile, tudo o mais constante, quanto maior a volatilidade implícita maior o preço da opção naquele strike. Outra forma de verificar esta relação é perceber que a grega Vega, que é calculada da mesma forma para calls e puts, é sempre positiva. Ou seja, um aumento no valor da volatiliade sempre leva a elevações no preço de uma opção. Desta forma é normal entre os praticantes de mercado fazer a precificação de opções em termos de “pontos de volatilidade” e não em valores monetários propriamente ditos. Isto porque o modelo B&amp;S, apesar de não ser o modelo correto (nenhum é) para a precificação de opções, é conhecido e de fácil entendimento para todos. Então todos os praticantes podem fazer suas cotações em termos de volatilidades implícitas, que são extraídas de opções baunilhas com o modelo B&amp;S, e somente na hora de fechar um negócio e liquidar o pagamento, o preço efetivo a ser pago é acordado entre as partes. 4.4 Estrutura a termo O mercado precifica a volatilidade implícita de forma que esta dependa também do tempo até expiração, bem como do preço de exercício, agregando uma segunda dimensão ao smile e transformando-o na famigerada superfície de volatilidade implícita. A volatilidade implícita tende a ser uma função crescente da maturidade quando as volatilidades de curto prazo são historicamente baixas e função decrescente da maturidade quando as volatilidades de curto prazo são historicamente altas. Isso porque existe uma expectativa de reversão a uma média de longo prazo embutida na volatilidade. Esta característica é explorada explicitamente por alguns modelos de volatilidade, como em Heston (1993). As superfícies de volatilidade combinam smiles com a estrutura a termo de volatilidade para tabular valores apropriados para precificar uma opção com qualquer preço de exercício e prazo de expiração. Da mesma forma como a curva de juros em um dado momento é uma descrição concisa dos preços dos títulos negociados naquele mercado, assim, para um ativo subjacente em particular em determinado momento, a superfície de volatilidade implícita fornece uma descrição resumida de seu mercado de opções. Considerando que os rendimentos dos títulos são diferenciados pelo seu tempo até o vencimento, as opções são diferenciadas por seu tempo até a expiração e o strike, logo requerem uma superfície ao invés de uma curva. A figura 4.3 demonstra uma superfície de volatilidade implícita do SPX em 15/09/2005, conforme apresentado em Gatheral (2011). Figura 4.3: Superfície de volatilidade implícita. 4.5 Arbitragem estática Antes de definir o que é arbitragem estática que pode estar presente em uma superfície de volatilidade (ou na superfície de preço de opções), vamos partir para a intuição por trás desta definição. O princípio de ausência de arbitragem é dominante na teoria financeira. Este princípio nos informa que não deve existir lucro sem que se incorra em algum tipo de risco, o lucro sempre é a remuneração do investidor que aceitou carregar alguma forma de risco durante o investimento. Portanto, não devem existir perfis de lucro acima da taxa livre de risco (payoffs positivos) com probabilidade de 100%. Primeiro consideramos uma trava de alta com opções do tipo call. Excluindo-se os custos de transação, esta operação sempre oferece um retorno positivo ou zero, conforme a figura 4.4. Por mais que esta estratégia esteja montada fora do dinheiro, sempre existe uma possibilidade de ela ter lucro, \\(S_T&gt;K\\) e portanto seu preço deve ser sempre maior que zero. Figura 4.4: Perfil de lucro de uma trava de alta. É claro que quanto mais ITM estejam as opções, maior seu preço e quanto mais fora do dinheiro menor será seu valor até o limite inferior zero. Se levarmos a diferença entre os strikes, \\(dK\\) a zero temos que: \\[\\begin{equation} \\frac{\\partial C}{\\partial K}\\leq 0 \\end{equation}\\] Este é o limite de arbitragem para travas de alta ou, mais conhecido pelo termo em inglês call spread no-arbitrage e impõe que os preços das calls devem ser uma função descrescente no strike. De forma equivalente e através da paridade compra-venda este limite de arbitragem para as puts é: \\[\\begin{equation} \\frac{\\partial P}{\\partial K}\\geq 0 \\end{equation}\\] 4.5.1 Arbitragem de borboleta Também deve ser imposta uma restrição na segunda derivada do preço das opções em relação ao strike, e esta é conhecida como limite de arbitragem para borboletas. Vejamos porquê. Considere uma estratégia do tipo borboleta, onde se compra uma quantia de calls no strike \\(K-dK\\), vende-se duas vezes esta quantia em \\(K\\) e compra-se novamente um lote em \\(K+dK\\), o perfil de lucro desta operação no vencimento está representado na figura 4.5. Figura 4.5: Borboleta realizada com calls. Seguindo a mesma linha de raciocínio anterior, como o payoff da borboleta é sempre não negativo também deve ser o seu valor para qualquer período anterior a expiração. Se denotarmos \\(\\pi_B\\) o valor da borboleta, então \\(\\pi_B\\geq0\\). Agora imagine que escalamos a estratégia de forma que um lote de compras (na venda são dois lotes) seja de tamanho \\(1/dK^2\\), o valor para a montagem desta operação deve ser, portanto: \\[\\begin{equation} \\pi_B=\\frac{C(K-dK)-2C(K)+C(K+dK)}{dK^2} \\end{equation}\\] E se levarmos ao limite em que \\(dK\\rightarrow 0\\), a equação acima torna-se justamente a segunda derivada do preço da call no strike \\(K\\). \\[\\begin{equation} \\begin{aligned} \\frac{\\partial^2 C(K)}{\\partial K^2}=&amp; \\pi_B\\\\ \\geq &amp; 0 \\end{aligned} \\tag{4.7} \\end{equation}\\] Ou seja, os preços das calls são uma função convexa nos strikes. O mesmo raciocínio pode ser feito para uma borboleta com puts e o resultado será equivalente, o preço das puts também deve ser uma função convexa nos strikes. 4.5.2 Arbitragem de calendário Passamos agora a analisar os limites de arbitragem na estrutura a termo da superfície de volatilidade. A arbitragem de calendário normalmente é expressa em termos de monotonicidade dos preços em relação ao período para expiração. Ou seja, quanto maior o prazo de maturidade de uma opção para um mesmo preço de exercício, maior deve ser seu valor. É fácil de entender este limite com base nas probabilidades de exercício. Como sabemos, em um processo estocástico do tipo MBG a variância do processo cresce conforme a raiz do tempo, \\(\\sqrt{\\tau}\\). Quanto maior a variância do ativo subjacente, maior a probabilidade deste alcançar um determinado preço, mais elevado ou não. Assim, seja uma call ou put OTM quanto mais distante estiver seu prazo de maturidade, maior a probabilidade de exercício e portanto, maior seu valor. Dado que a relação de volatilidade total implícita e preço de uma opção também é direta e positiva, conforme demonstrado na Seção 4.3, segue que a volatilidade total deve ser não decrescente no tempo para expiração. Esta relação pode ser expressa através da seguinte equação para uma call precificada através de B&amp;S: \\[\\begin{equation} \\frac{\\partial C_{BS}(k, \\theta(\\tau))}{\\partial \\tau}=\\partial_\\theta C_{BS}\\cdot\\partial_\\tau \\theta \\geq 0 \\tag{4.8} \\end{equation}\\] onde \\(\\partial_\\theta C_{BS}\\) é a derivada parcial do preço da call em relação a volatilidade total implícita, que já demonstramos ser positiva e \\(\\partial_\\tau \\theta\\) é a derivada parcial da volatilidade total implícita em relação ao tempo para maturidade que, portanto, deve ser maior ou igual a zero para obedecer a restrição imposta ao preço da call. 4.6 Limites de inclinação Se mantivermos a volatilidade implícita constante para todos os strikes, os preços das calls no modelo B&amp;S devem ser decrescentes. Por outro lado, para um strike fixo, o preço de uma call se eleva à medida que a volatilidade implícita aumenta. Suponha por um momento que a volatilidade implícita varia com o strike como é o caso nos smiles. À medida que o strike aumenta, se a volatilidade implícita aumentar muito rapidamente, seu efeito sobre o preço da call pode mais que compensar o declínio no preço devido a elevação do preço de exercício e, assim, levar a um aumento líquido no preço da opção. Isso violaria o requisito de que \\(\\partial C /\\partial K \\leq 0\\) e, portanto, leva a um limite superior na taxa em que a volatilidade implícita pode aumentar com o strike. Novamente, o mesmo raciocínio pode ser imposto para o lado das puts. A volatilidade implícita não pode se elevar tão rapidamente quando os strikes se reduzem de forma que uma put de strike menor tenha valor mais elevado que outra que esteja mais próxima do dinheiro. Finalmente, um sumário dos limites impostos a uma superfície de preços de opções (calls no caso apresentado), que implicam em limites para a superfície de volatilidade é apresentado abaixo5: \\(\\partial_\\tau C \\geq 0\\) \\(\\lim\\limits_{K\\rightarrow\\infty}C(K, \\tau)=0\\) \\(\\lim\\limits_{K\\rightarrow-\\infty}C(K, \\tau)+K=a, \\quad a \\in \\mathbb R\\) \\(C(K, \\tau)\\) é convexa em \\(K\\) \\(C(K, \\tau)\\) é não-negativa 4.7 Distribuição implícita O modelo B&amp;S é baseado na suposição que o ativo subjacente segue uma distribuição log-normal em seus preços. Caso esta suposição fosse de fato realizada no mercado, o smile de volatilidade seria uma reta completamente horizontal, não haveria variação na volatilidade implícita conforme o preço de exercício. Entretanto, esta não é a realidade dos smiles e podemos fazer a pergunta inversa portanto, qual a distribuição neutra ao risco que está implícita no smile de volatilidade? Certamente não é uma log-normal. Na verdade, a densidade da distribuição que está implícita em um smile nada mais é que a convexidade deste smile, ou seja, sua segunda derivada em relação ao strike. Esta distribuição implícita também é por vezes chamada de RND (risk neutral density) e é muito útil para fazer a precificação de outras opções que não são observadas no smile ou extrair probabilidades de ocorrência de eventos precificadas pelo mercado. Pode-se obter este resultado a partir da definição do valor de uma call e é conhecido como a fórmula de Breeden and Litzenberger (1978). O valor de uma call é o valor esperado do payoff terminal desta call ponderado pela densidade neutra ao risco do subjacente. Ou seja: \\[\\begin{equation} C(S, t)=e^{-r\\tau}\\int\\limits_{0}^\\infty p(S,t,S_T,T)\\max\\{S_T-K, 0\\}dS_T \\end{equation}\\] onde \\(p(\\cdot)\\) é a densidade neutra ao risco e estamos supondo uma taxa de juros livre de risco constante durante o período de vida da opção. Como o payoff da call é não linear, sendo zero para qualquer valor de \\(S_T \\leq K\\) e igual a \\(S_T-K\\) quando \\(S_T &gt; K\\), podemos escrever esta equação como: \\[\\begin{equation} C(S, t)=e^{-r\\tau}\\int\\limits_{K}^\\infty p(S,t,S_T,T)(S_T-K)dS_T \\end{equation}\\] que pode ser rearranjada, com alguma simplificação na notação, da seguinte forma. \\[\\begin{equation} \\begin{aligned} \\frac{\\partial C}{\\partial K}=&amp; -e^{-r\\tau}\\int\\limits_{K}^\\infty p(S_T)dS_T\\\\ e^{r\\tau}\\frac{\\partial C}{\\partial K}=&amp; \\int\\limits_{-\\infty}^K p(S_T)dS_T\\\\ e^{r\\tau}\\frac{\\partial^2 C}{\\partial K^2}=&amp; \\ p(K)\\\\ \\frac{\\partial^2 C_B}{\\partial K^2}=&amp; \\ p(K) \\end{aligned} \\tag{4.9} \\end{equation}\\] Onde usou-se a notação \\(C_B\\) para denotar a formulação de Black para o preço de uma call. Ou seja, a segunda derivada em relação ao strike do preço não descontado de uma call é a distribuição neutra ao risco do ativo subjacente, e é válida para todos preços de exercício. Portanto, se desejarmos saber qual a distribuição de probabilidades de preços do ativo subjacente em uma data futura que possua vencimento de opções, basta encontrarmos a convexidade do smile dos preços forward daquele vencimento6. 4.8 Conclusão O modelo de Black-Scholes-Merton, pode ser considerado a pedra fundamental para a precifição de opções. Entretanto, este modelo apresenta uma séries de limitações que fazem com que os praticantes de mercado utilizem outras técnicas neste mercado. Uma destas é o uso do smile de volatilidade e sua interpretação como forma de precificar opções e extrair informações implícitas nos preços. A assimetria do smile e suas asas informam que as distribuições de probabilidades para o ativo subjacente não são exatamente log-normais, e podem apresentar discrepâncias significativas, especialmente nas caudas da distribuição que muito interessam a gestão de risco, por exemplo. Este foi um artigo denso, porém com vários conceitos importantes para a compreensão do comportamento da superfície de volatilidade. A estrutura a termo também é existente na volatilidade implícita e está limitada pela ausência de arbitragem do tipo calendário. O smile de volatilidade, que é uma fatia da superfície com prazo de expiração constante, possui suas próprias limitações de forma, com a ausência de arbitragem do tipo borboleta e limitações quanto a inclinação. Por fim, foi demonstrado como a convexidade do smile de preços fornece a distribuição implícita para os preços do ativo subjacente para a data de expiração das opções. Bibliografia "],
["calibracao.html", "Capítulo 5 Métodos de Calibração 5.1 Calibração versus Interpolação 5.2 Spline cúbica 5.3 Suavização 5.4 Parametrização 5.5 Conclusão 5.6 Referências", " Capítulo 5 Métodos de Calibração Neste post iremos mostrar as diferenças existentes entre “interpolação”, “suavização” e “parametrização” de superfícies de volatilidade. Como já apresentado em posts anteriores, existem diversas formas de interpolar, extrapolar, parametrizar e calibrar smiles de volatilidade. Exsitem vantagens e desvantagens para cada método. 5.1 Calibração versus Interpolação Uma forma simples de gerar um smile de volatilidade a partir de dados observados no mercado é a interpolação destes dados. Diversas formas de interpolação existem, sendo talvez a mais conhecida a spline cúbica. Não é a proposta deste artigo detalhar os procedimentos de interpolação, restando saber que em tal procedimento é gerada uma função contínua em partes (piecewise) que passa por todos os pontos observados. Uma interpolação força a passagem da função interpolada em todos os seus pontos de referência, como se estivesse ligando os pontos em um desenho a mão livre. Portanto, nestes pontos o erro da interpolação é zero por definição, entretanto em pontos intermediários podem surgir erros, inclusive aqueles que possibilitam a existência de arbitragem entre strikes de um mesmo smile7. Em contraposição a métodos de interpolação, podem ser derivados métodos de suavização (smoothing) ou então a parametrização do smile de volatilidade. Seja suavização, ou parametrização, estes métodos não forçam a passagem da função que representa o smile pelos pontos de mercado, mas buscam minimizar alguma função perda com relação aos desvios em relação a estes pontos ao mesmo tempo em que buscam “suavizar” o smile, para que este não apresente variações bruscas entre os strikes ou alterações de convexidade na curva de preços, que não são condizentes com a teoria de precificação de derivativos. Um método paramétrico, como o SVI, Heston, SABR ou Volatilidade Local, busca ajustar às volatilidades implícitas observadas através dos preços das opções sendo praticados no mercado uma determinada função, que possui parâmetros em sua definição que por sua vez determinam a forma desta função. Ao se ajustar os parâmetros, pode-se adequar a função para ficar “o mais próxima possível” dos dados observados, sem necessariamente, no entanto, passar por todos estes pontos. A figura abaixo tenta mostrar as diferenças entre uma interpolação spline cúbica, uma suavização e uma parametrização SVI. Enquanto que a interpolação liga todos os pontos marcados, a suavização e a parametrização não necessariamente passam sobre estes pontos mas fornecem uma curva mais “suave”, sem trocas de convexidade, o que gera oportunidades de arbitragem e probabilidades negativas de ocorrência de determinados preços para o ativo subjacente, que ferem os princípios de precificação de opções. Os dados utilizados neste e nos próximos artigos sobre superfícies de volatlidade foram obtidos do site ivolatility.com na forma de amostra gratuita fornecida livremente. O ativo subjacente é o ETF IWM para a data de 21/09/2017. Figura 5.1: Diferentes métodos de ajuste de dados a um smile. Pode-se verificar como os métodos SVI e a suavização não passam sobre todos os pontos marcados, com a suavização tendo dificuldade com a curvatura nos valores mais altos de moneyness e a SVI possuindo uma inclinação mais branda na asa esquerda do smile. 5.2 Spline cúbica Este método é possivelmente um dos mais flexíveis e conhecidos de interpolação de dados univariados existente, embora também exista sua versão bi-dimensional. Uma spline nada mais é que “uma curva definida matematicamente por dois ou mais pontos de controle”8. No caso da spline cúbica, esta é uma função polinomial de grau 3 definida em cada subintervalo demarcados pelos pontos de controle, no caso de interpolação são todos nós. Ou seja, considere um segmento entre dois pontos consecutivos \\([c, d]\\in S\\) a spline é uma função cúbica com seus parâmetros calculados pelo algoritmo de ajuste. Para o próximo intervalo de pontos dentro do domínio da função, um novo polinômio de grau 3 é ajustado, sendo que nos pontos de nós uma restrição de igualdade entre as derivadas nos dois segmentos é aplicada para garantir a suavidade da função interpolada como um todo. Assim, uma spline cúbica é uma função contínua, suave e diferenciável até a segunda ordem. Entretanto, suas derivadas, apesar de contínuas, podem não ser suaves, especialmente aquela de segunda ordem que pode apresentar pontos de “ruptura”. Esta característica de uma spline cúbica a torna pouco atrativa para a inferência de distribuições de probabilidade a partir de dados de volatilidade ou mesmo dos preços de opções. Figura 5.2: Cada segmento de uma spline cúbica é um polinômio de grau 3 diferente. 5.3 Suavização A técnica de suavização é muito semelhante a interpolação, inclusive o método spline também é aplicado, com algumas modificações de forma que nem todos os pontos fornecidos serão nós. Na spline de suavização (ou aproximação), os pontos fornecidos são separados entre os nós, onde a função deve passar e pontos de controle, que são utilizados para controlar a curvatura da função nestes pontos. Estas suavizações são principalmente utilizadas quando se possui muitas observações sujeitas a ruídos, de forma que uma interpolação entre todos os pontos seria tanto impraticável quanto sem sentido. O que se deseja, portanto, é uma função aproximada que melhor descreva o processo sob análise. Um ponto em comum entre estas técnicas é o parâmetro de suavização, ausente, na interpolação, que controla a “suavidade” da função estimada. Figura 5.3: Menor parâmetro de suavização gera granularidade na curva. 5.4 Parametrização E por fim as técnicas de parametrização. Nesta categoria estão diversos conhecidos modelos de superfícies de volatilidade implícita, dentre eles os modelos de Heston (1993), Volatilidade Local de Dupire (1994) e SVI de Gatheral (2004). Em comum, estes modelos tentam parametrizar a superfície, e por conseguinte o smile de volatilidade, de acordo com alguma função, em geral não-linear, que possui características condizentes com a teoria de precificão de derivativos e também a observação empírica das superfícies. Por exemplo, a parametrização raw da SVI possui a seguinte forma para a variância total9 : \\[ w(k) = a + b\\left(\\rho(k-m)+\\sqrt{(k-m)^2 + \\sigma^2}\\right)\\] que fornece um espaço de cinco parâmetros \\(\\chi_B=\\{a, b, \\rho, m, \\sigma\\}\\) que definem o smile e devem, portanto, serem calibrados a partir de dados observados no mercado. O procedimento de calibração consiste em encontrar o conjunto de parâmetros que minimizam uma função perda entre a volatilidade prevista pelo modelo e os dados de mercado, enquanto satisfazem algumas restrições adicionais, como “ausência de arbitragem”, suavidade, etc. Trata-se, via de regra, de problemas de otimização não-linear com restrições de inequalidade também não-lineares. 5.4.1 Função perda A função perda, ou função de calibração pode ser definida de diversas maneiras, de forma geral, para uma determinada maturidade, ela toma a forma: \\[L=\\sum\\limits_{i=1}^n\\lambda_i||\\hat w(k_i)-w_{imp}(k_i)||\\] onde \\(||\\cdot||\\) é alguma medida de norma, sendo a mais conhecida o quadrado das diferenças, dando origem a minimização do erro quadrático médio (RMSE). Para este smile sendo calibrado existem \\(n\\) strikes (\\(k_i\\)) e suas volatilidades implícitas observadas são \\(w_{imp}(k_i)\\). A resposta do modelo para um determinado strike é \\(\\hat w(k_i)\\) e \\(\\lambda_i\\) são os pesos dados na função perda para cada um destes strikes. Os pesos \\(\\lambda_i\\) são utilizados para ponderar as observações das volatilidades mais importantes para o cálculo, onde se deseja que a curva ajustada possua um menor erro. Em geral, estes pesos são calculado como inversamente proporcionais: ao quadrado dos spreads bid-ask, para dar mais importância às opções mais líquidas ao quadrado da grega vega calculada a partir do modelo BSM 5.4.2 Otimizadores Os otimizadores são os algoritmos pelos quais o problema de minimização posto é resolvido. Se a função perda é convexa, e ela deve ser construída de forma a ser, mesmo que não estritamente, então ela possui um ou mais pontos de mínimo onde o gradiente desta função é igual a zero. O que os otimizadores fazem é buscar o conjunto de parâmetros que minimizam a função perda e atendem as restrições impostas simultaneamente. Os otimizadores podem ser classificados em dois grandes grupos, globais e locais. Algoritmos locais dependem de uma estimativa inicial dos parâmetros para começarem a busca pelo mínimo. Seguindo uma regra utilizando-se o gradiente da função ou alguma heurística, estes otimizadores caminham em direção ao ponto de mínimo mais próximo da estimativa inicial, daí o nome “local”. Como desvantagem destes otimizadores é a mais evidente é que se a função perda for altamente não-linear, com diversos pontos de mínimo local, este otimizador pode ficar preso em um destes pontos sem nunca, no entanto, encontrar o mínimo global. Eles são, portanto muito sensíveis à estimativa inicial dos parâmetros. Por sua vez, otimizadores globais buscam mapear todo o espaço factível para os parâmetros e encontrar o ponto mínimo da função perda dentro deste espaço. Estes algoritmos não dependem de estimativas iniciais, uma vez que tentarão avaliar o espaço completo. São utilizados quando o problema de minimização é não-linear e possui múltiplos pontos de mínimo local. Estes algoritmos usam alguma forma de heurística para encontrar a região onde o mínimo global está localizado, mas são, em geral, ineficientes em apontar rapidamente onde este ponto de mínimo se encontra com precisão. Por esta razão, é frequente a utilização de otimizadores globais com um posterior refinamento de sua solução por algum algoritmo local. Abaixo apresentamos alguns exemplos mais comuns de otimizadores, tanto locais quanto globais: Gauss-Newton: Este método é utilizado para encontrar as raízes de alguma função. Para encontrar o ponto de mínimo da função perda, precisa-se encontrar as raízes do gradiente desta função, portanto o método de Newton em otimização faz uso da função gradiente. Este é um método de otimização local. Levenberg-Marquardt: Método muito utilizado para problemas não-lineares, ele parte de uma modificação ao método de Gauss-Newton ao introduzir um fator de amortecimento calculado iterativamente. L-BFGS-B: BFGS é um método conhecido como quasi-Newton, onde não é necessário calcular a Hessiana do problema, ela é aproximada a partir do próprio gradiente. É bastante utilizado para resolver problemas não-lineares e em sua versão L-BFGS-B pode lidar com restrições do tipo box, intervalo dos parâmetros é fixo. Nelder-Mead: Este é um método livre do uso de gradiente, já que usa uma heurística para construir um simplex e a partir deste “procurar” por um mínimo. Bastante utilizado quando a função objetivo pode não ser diferenciável. Faz uso de um simplex inicial, que pode ser grande o suficiente para encampar o mínimo global, entretanto, não se classifica como um otimizador global. Algoritmo Genético: Este método utiliza conceitos da seleção natural para gerar os resultados da otimização. É um otimizador global, no sentido que independe de uma estimativa inicial de parâmetros e faz uma busca por todo o espaço factível. Em um algoritmo genético, uma população aleatória inicial de parâmetros é criada e a partir desta, as gerações evoluem conforme mutações e cross-over de características e é avaliado o fitness de cada conjunto de parâmetros até um deles ser considerado adequado. Evolução Diferencial: É um método de otimização global, assim como o Algoritmo Genético e o Enxame de Partículas. Sua diferença reside no fato de que sua população inicial é constantemente avaliada e deslocada de posição. Se o agente obtiver uma situação melhor (menor valor para a função perda) na nova posição, esta agora faz parte da população. Desta forma os agentes, antes espalhados pelo espaço factível dos parâmetros, tendem a convergir para um ponto com o menor valor da função perda. Enxame de Partículas: Do inglês, Particle Swarm Optimization - PSO este método é semelhante ao DE (Differential Evolution) porém as partículas (o equivalente dos agentes no DE) matém informações sobre a posição da melhor partícula até então, de forma a fazer com que as partículas tendam para a melhor solução. 5.5 Conclusão Dependendo do objetivo da aplicação, superfícies de volatilidade podem ser interpoladas, suavizadas ou parametrizadas. A parametrização tem recebido especial interesse pois pode, ao mesmo tempo que garante uma superfície livre de arbitragem estática se devidamente construída, ajustar-se muito bem aos dados observados e gerar distribuições neutras ao risco implícitas factíveis. Para gerar uma superfície parametrizada, primeiramente é necessário um modelo teórico com propriedades desejáveis e que se ajuste aos dados de mercado quando calibrado. Escolhido este modelo paramétrico, passa-se a calibração do mesmo onde exsitem diversas opções de escolha entre otimizadores. Ao final do processo teremos um modelo de superfície devidamente parametrizado com valores que melhor se ajustam segundo alguma função perda escolhida. Com a superfície de volatilidade calibrada, as aplicações possíveis incluem a precificação de derivativos, gerenciamento de risco, simulações de Monte Carlo, análises de stress, entre outras. 5.6 Referências Bibliografia "],
["bibliografia.html", "Bibliografia", " Bibliografia "]
]
