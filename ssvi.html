<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 Superfície SVI | Introdução a Superfície de Volatilidade</title>
  <meta name="description" content="Gitbook sobre superfícies de volatilidade para o Clube de Finanças ESAG." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 Superfície SVI | Introdução a Superfície de Volatilidade" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Gitbook sobre superfícies de volatilidade para o Clube de Finanças ESAG." />
  <meta name="github-repo" content="rfbressan/vol_surface_gitbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 Superfície SVI | Introdução a Superfície de Volatilidade" />
  
  <meta name="twitter:description" content="Gitbook sobre superfícies de volatilidade para o Clube de Finanças ESAG." />
  

<meta name="author" content="Rafael Felipe Bressan" />


<meta name="date" content="2019-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="svi.html">
<link rel="next" href="monte-carlo.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução a Superfície de Volatilidade</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os Autores</a><ul>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#rafael-felipe-bressan"><i class="fa fa-check"></i>Rafael Felipe Bressan</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#erik-naoki-kawano"><i class="fa fa-check"></i>Erik Naoki Kawano</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#glauber-naue"><i class="fa fa-check"></i>Glauber Naue</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#gabriel-dias"><i class="fa fa-check"></i>Gabriel Dias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="opcoes.html"><a href="opcoes.html"><i class="fa fa-check"></i><b>1</b> Introdução as opções</a><ul>
<li class="chapter" data-level="1.1" data-path="opcoes.html"><a href="opcoes.html#conceitos-in-the-money-at-the-money-e-out-the-money"><i class="fa fa-check"></i><b>1.1</b> Conceitos in the money, at the money e out the money</a></li>
<li class="chapter" data-level="1.2" data-path="opcoes.html"><a href="opcoes.html#modelos-americano-e-europeu-de-opcoes"><i class="fa fa-check"></i><b>1.2</b> Modelos americano e europeu de opções</a></li>
<li class="chapter" data-level="1.3" data-path="opcoes.html"><a href="opcoes.html#hedge"><i class="fa fa-check"></i><b>1.3</b> Hedge</a></li>
<li class="chapter" data-level="1.4" data-path="opcoes.html"><a href="opcoes.html#travas"><i class="fa fa-check"></i><b>1.4</b> Travas</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="processos-estocasticos.html"><a href="processos-estocasticos.html"><i class="fa fa-check"></i><b>2</b> Processos Estocásticos em Finanças</a><ul>
<li class="chapter" data-level="2.1" data-path="processos-estocasticos.html"><a href="processos-estocasticos.html#markov"><i class="fa fa-check"></i><b>2.1</b> Processos de Markov</a></li>
<li class="chapter" data-level="2.2" data-path="processos-estocasticos.html"><a href="processos-estocasticos.html#mb"><i class="fa fa-check"></i><b>2.2</b> Movimento Browniano</a></li>
<li class="chapter" data-level="2.3" data-path="processos-estocasticos.html"><a href="processos-estocasticos.html#definicao"><i class="fa fa-check"></i><b>2.3</b> Definição</a></li>
<li class="chapter" data-level="2.4" data-path="processos-estocasticos.html"><a href="processos-estocasticos.html#mbg"><i class="fa fa-check"></i><b>2.4</b> Movimento Browniano Geométrico</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bsm.html"><a href="bsm.html"><i class="fa fa-check"></i><b>3</b> Modelo Black-Scholes-Merton</a><ul>
<li class="chapter" data-level="3.1" data-path="bsm.html"><a href="bsm.html#portfolio-de-replicacao"><i class="fa fa-check"></i><b>3.1</b> Portfólio de replicação</a></li>
<li class="chapter" data-level="3.2" data-path="bsm.html"><a href="bsm.html#precificacao-neutra-ao-risco"><i class="fa fa-check"></i><b>3.2</b> Precificação neutra ao risco</a></li>
<li class="chapter" data-level="3.3" data-path="bsm.html"><a href="bsm.html#encontrando-a-equacao-de-black-scholes"><i class="fa fa-check"></i><b>3.3</b> Encontrando a equação de Black-Scholes</a></li>
<li class="chapter" data-level="3.4" data-path="bsm.html"><a href="bsm.html#solucao-analitica"><i class="fa fa-check"></i><b>3.4</b> Solução analítica</a></li>
<li class="chapter" data-level="3.5" data-path="bsm.html"><a href="bsm.html#putcallparity"><i class="fa fa-check"></i><b>3.5</b> Paridade compra e venda</a></li>
<li class="chapter" data-level="3.6" data-path="bsm.html"><a href="bsm.html#gregas"><i class="fa fa-check"></i><b>3.6</b> As Gregas</a><ul>
<li class="chapter" data-level="3.6.1" data-path="bsm.html"><a href="bsm.html#delta"><i class="fa fa-check"></i><b>3.6.1</b> Delta</a></li>
<li class="chapter" data-level="3.6.2" data-path="bsm.html"><a href="bsm.html#gamma"><i class="fa fa-check"></i><b>3.6.2</b> Gamma</a></li>
<li class="chapter" data-level="3.6.3" data-path="bsm.html"><a href="bsm.html#theta"><i class="fa fa-check"></i><b>3.6.3</b> Theta</a></li>
<li class="chapter" data-level="3.6.4" data-path="bsm.html"><a href="bsm.html#vega"><i class="fa fa-check"></i><b>3.6.4</b> Vega</a></li>
<li class="chapter" data-level="3.6.5" data-path="bsm.html"><a href="bsm.html#rho"><i class="fa fa-check"></i><b>3.6.5</b> Rho</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="smile.html"><a href="smile.html"><i class="fa fa-check"></i><b>4</b> Smile de Volatilidade</a><ul>
<li class="chapter" data-level="4.1" data-path="smile.html"><a href="smile.html#reparametrizando"><i class="fa fa-check"></i><b>4.1</b> Reparametrizando B&amp;S e definição de moneyness</a></li>
<li class="chapter" data-level="4.2" data-path="smile.html"><a href="smile.html#caracsmile"><i class="fa fa-check"></i><b>4.2</b> Características de smiles de volatilidade</a><ul>
<li class="chapter" data-level="4.2.1" data-path="smile.html"><a href="smile.html#mercados-cambiais"><i class="fa fa-check"></i><b>4.2.1</b> Mercados cambiais</a></li>
<li class="chapter" data-level="4.2.2" data-path="smile.html"><a href="smile.html#mercados-de-equities"><i class="fa fa-check"></i><b>4.2.2</b> Mercados de <em>equities</em></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="smile.html"><a href="smile.html#smileprecificacao"><i class="fa fa-check"></i><b>4.3</b> Smile como forma de precificação</a></li>
<li class="chapter" data-level="4.4" data-path="smile.html"><a href="smile.html#estrutura-a-termo"><i class="fa fa-check"></i><b>4.4</b> Estrutura a termo</a></li>
<li class="chapter" data-level="4.5" data-path="smile.html"><a href="smile.html#arbestatica"><i class="fa fa-check"></i><b>4.5</b> Arbitragem estática</a><ul>
<li class="chapter" data-level="4.5.1" data-path="smile.html"><a href="smile.html#arbitragem-de-borboleta"><i class="fa fa-check"></i><b>4.5.1</b> Arbitragem de borboleta</a></li>
<li class="chapter" data-level="4.5.2" data-path="smile.html"><a href="smile.html#arbitragem-de-calendario"><i class="fa fa-check"></i><b>4.5.2</b> Arbitragem de calendário</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="smile.html"><a href="smile.html#limites-de-inclinacao"><i class="fa fa-check"></i><b>4.6</b> Limites de inclinação</a></li>
<li class="chapter" data-level="4.7" data-path="smile.html"><a href="smile.html#rnd"><i class="fa fa-check"></i><b>4.7</b> Distribuição implícita</a></li>
<li class="chapter" data-level="4.8" data-path="smile.html"><a href="smile.html#conclusao"><i class="fa fa-check"></i><b>4.8</b> Conclusão</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="superficies.html"><a href="superficies.html"><i class="fa fa-check"></i><b>5</b> Superfícies de volatilidade</a><ul>
<li class="chapter" data-level="5.1" data-path="superficies.html"><a href="superficies.html#modelos-estocasticos"><i class="fa fa-check"></i><b>5.1</b> Modelos estocásticos</a><ul>
<li class="chapter" data-level="5.1.1" data-path="superficies.html"><a href="superficies.html#heston"><i class="fa fa-check"></i><b>5.1.1</b> Heston</a></li>
<li class="chapter" data-level="5.1.2" data-path="superficies.html"><a href="superficies.html#sabr"><i class="fa fa-check"></i><b>5.1.2</b> SABR</a></li>
<li class="chapter" data-level="5.1.3" data-path="superficies.html"><a href="superficies.html#bates"><i class="fa fa-check"></i><b>5.1.3</b> Bates</a></li>
<li class="chapter" data-level="5.1.4" data-path="superficies.html"><a href="superficies.html#volatilidade-local"><i class="fa fa-check"></i><b>5.1.4</b> Volatilidade local</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="superficies.html"><a href="superficies.html#modelos-parametricos"><i class="fa fa-check"></i><b>5.2</b> Modelos paramétricos</a><ul>
<li class="chapter" data-level="5.2.1" data-path="superficies.html"><a href="superficies.html#sec:svi"><i class="fa fa-check"></i><b>5.2.1</b> SVI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="superficies.html"><a href="superficies.html#modelos-nao-parametricos"><i class="fa fa-check"></i><b>5.3</b> Modelos não-paramétricos</a><ul>
<li class="chapter" data-level="5.3.1" data-path="superficies.html"><a href="superficies.html#interpolacao-e-suavizacao-spline"><i class="fa fa-check"></i><b>5.3.1</b> Interpolação e suavização spline</a></li>
<li class="chapter" data-level="5.3.2" data-path="superficies.html"><a href="superficies.html#algoritmos-livres-de-arbitragem"><i class="fa fa-check"></i><b>5.3.2</b> Algoritmos livres de arbitragem</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="superficies.html"><a href="superficies.html#extrapolacao-do-smile"><i class="fa fa-check"></i><b>5.4</b> Extrapolação do smile</a></li>
<li class="chapter" data-level="5.5" data-path="superficies.html"><a href="superficies.html#conclusao-1"><i class="fa fa-check"></i><b>5.5</b> Conclusão</a></li>
<li class="chapter" data-level="5.6" data-path="superficies.html"><a href="superficies.html#referencias"><i class="fa fa-check"></i><b>5.6</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="calibracao.html"><a href="calibracao.html"><i class="fa fa-check"></i><b>6</b> Métodos de Calibração</a><ul>
<li class="chapter" data-level="6.1" data-path="calibracao.html"><a href="calibracao.html#calibracao-versus-interpolacao"><i class="fa fa-check"></i><b>6.1</b> Calibração versus Interpolação</a></li>
<li class="chapter" data-level="6.2" data-path="calibracao.html"><a href="calibracao.html#spline-cubica"><i class="fa fa-check"></i><b>6.2</b> Spline cúbica</a></li>
<li class="chapter" data-level="6.3" data-path="calibracao.html"><a href="calibracao.html#suavizacao"><i class="fa fa-check"></i><b>6.3</b> Suavização</a></li>
<li class="chapter" data-level="6.4" data-path="calibracao.html"><a href="calibracao.html#parametrizacao"><i class="fa fa-check"></i><b>6.4</b> Parametrização</a><ul>
<li class="chapter" data-level="6.4.1" data-path="calibracao.html"><a href="calibracao.html#funcao-perda"><i class="fa fa-check"></i><b>6.4.1</b> Função perda</a></li>
<li class="chapter" data-level="6.4.2" data-path="calibracao.html"><a href="calibracao.html#otimizadores"><i class="fa fa-check"></i><b>6.4.2</b> Otimizadores</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="calibracao.html"><a href="calibracao.html#conclusao-2"><i class="fa fa-check"></i><b>6.5</b> Conclusão</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="svi.html"><a href="svi.html"><i class="fa fa-check"></i><b>7</b> Calibrando uma SVI</a><ul>
<li class="chapter" data-level="7.1" data-path="svi.html"><a href="svi.html#modelo-svi"><i class="fa fa-check"></i><b>7.1</b> Modelo SVI</a></li>
<li class="chapter" data-level="7.2" data-path="svi.html"><a href="svi.html#restricoes-de-nao-arbitragem"><i class="fa fa-check"></i><b>7.2</b> Restrições de não-arbitragem</a></li>
<li class="chapter" data-level="7.3" data-path="svi.html"><a href="svi.html#reparametrizacao-quasi-explicit"><i class="fa fa-check"></i><b>7.3</b> Reparametrização Quasi-explicit</a><ul>
<li class="chapter" data-level="7.3.1" data-path="svi.html"><a href="svi.html#pq"><i class="fa fa-check"></i><b>7.3.1</b> Solução explícita do problema reduzido</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="svi.html"><a href="svi.html#algoritmo"><i class="fa fa-check"></i><b>7.4</b> Algoritmo</a></li>
<li class="chapter" data-level="7.5" data-path="svi.html"><a href="svi.html#resultados"><i class="fa fa-check"></i><b>7.5</b> Resultados</a></li>
<li class="chapter" data-level="7.6" data-path="svi.html"><a href="svi.html#conclusao-3"><i class="fa fa-check"></i><b>7.6</b> Conclusão</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ssvi.html"><a href="ssvi.html"><i class="fa fa-check"></i><b>8</b> Superfície SVI</a><ul>
<li class="chapter" data-level="8.1" data-path="ssvi.html"><a href="ssvi.html#reparametrizacoes-equivalentes"><i class="fa fa-check"></i><b>8.1</b> Reparametrizações equivalentes</a></li>
<li class="chapter" data-level="8.2" data-path="ssvi.html"><a href="ssvi.html#superficie-svi"><i class="fa fa-check"></i><b>8.2</b> Superfície SVI</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ssvi.html"><a href="ssvi.html#heston-1"><i class="fa fa-check"></i><b>8.2.1</b> Heston</a></li>
<li class="chapter" data-level="8.2.2" data-path="ssvi.html"><a href="ssvi.html#lei-de-potencia"><i class="fa fa-check"></i><b>8.2.2</b> Lei de potência</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ssvi.html"><a href="ssvi.html#condicoes-de-nao-arbitragem"><i class="fa fa-check"></i><b>8.3</b> Condições de não-arbitragem</a></li>
<li class="chapter" data-level="8.4" data-path="ssvi.html"><a href="ssvi.html#densidade-neutra-ao-risco"><i class="fa fa-check"></i><b>8.4</b> Densidade neutra ao risco</a></li>
<li class="chapter" data-level="8.5" data-path="ssvi.html"><a href="ssvi.html#superficie-de-volatilidade-local"><i class="fa fa-check"></i><b>8.5</b> Superfície de volatilidade local</a></li>
<li class="chapter" data-level="8.6" data-path="ssvi.html"><a href="ssvi.html#calibracao-da-ssvi"><i class="fa fa-check"></i><b>8.6</b> Calibração da SSVI</a></li>
<li class="chapter" data-level="8.7" data-path="ssvi.html"><a href="ssvi.html#conclusao-4"><i class="fa fa-check"></i><b>8.7</b> Conclusão</a></li>
<li class="chapter" data-level="8.8" data-path="ssvi.html"><a href="ssvi.html#referencias-1"><i class="fa fa-check"></i><b>8.8</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="monte-carlo.html"><a href="monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Simulação de Monte Carlo</a><ul>
<li class="chapter" data-level="9.1" data-path="monte-carlo.html"><a href="monte-carlo.html#simulacao-de-monte-carlo"><i class="fa fa-check"></i><b>9.1</b> Simulação de Monte Carlo</a></li>
<li class="chapter" data-level="9.2" data-path="monte-carlo.html"><a href="monte-carlo.html#implementacao-em-r"><i class="fa fa-check"></i><b>9.2</b> Implementação em R</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="redes-neurais.html"><a href="redes-neurais.html"><i class="fa fa-check"></i><b>10</b> Precificação de Opções via Redes Neurais</a><ul>
<li class="chapter" data-level="10.1" data-path="redes-neurais.html"><a href="redes-neurais.html#hipoteses-de-black-scholes"><i class="fa fa-check"></i><b>10.1</b> Hipóteses de Black &amp; Scholes</a></li>
<li class="chapter" data-level="10.2" data-path="redes-neurais.html"><a href="redes-neurais.html#ensinando-uma-maquina-a-precificar-opcoes"><i class="fa fa-check"></i><b>10.2</b> Ensinando uma máquina a precificar opções</a></li>
<li class="chapter" data-level="10.3" data-path="redes-neurais.html"><a href="redes-neurais.html#redes-neurais"><i class="fa fa-check"></i><b>10.3</b> Redes Neurais</a></li>
<li class="chapter" data-level="10.4" data-path="redes-neurais.html"><a href="redes-neurais.html#feed-forward-network"><i class="fa fa-check"></i><b>10.4</b> Feed forward network</a></li>
<li class="chapter" data-level="10.5" data-path="redes-neurais.html"><a href="redes-neurais.html#backpropagation"><i class="fa fa-check"></i><b>10.5</b> Backpropagation</a></li>
<li class="chapter" data-level="10.6" data-path="redes-neurais.html"><a href="redes-neurais.html#rede-neural-no-r"><i class="fa fa-check"></i><b>10.6</b> Rede neural no R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i>Bibliografia</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução a Superfície de Volatilidade</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ssvi" class="section level1">
<h1><span class="header-section-number">Capítulo 8</span> Superfície SVI</h1>
<p>Superfície SVI, ou somente SSVI é uma generalização do modelo <a href="svi.html#svi">SVI</a> de <span class="citation">(Gatheral <a href="#ref-Gatheral2004">2004</a>)</span> que busca solucionar o problema de restrição dos parâmetros do modelo para evitar a presença de arbitragem do tipo borboleta em um dado <em>smile</em>. Este modelo foi proposto por <span class="citation">(Gatheral and Jacquier <a href="#ref-Gatheral2014">2014</a>)</span> e extende o modelo SVI original apresentando duas outras parametrizações equivalentes e então o modelo para superfícies propriamente dito.</p>
<div id="reparametrizacoes-equivalentes" class="section level2">
<h2><span class="header-section-number">8.1</span> Reparametrizações equivalentes</h2>
<p>Existem duas outras formas de se apresentar um modelo SVI que são equivalentes a parametrização <a href="superficies.html#superficies"><em>RAW</em></a> já apresentada. Estas são as parametrizações “Natural” e “Jump-Wings” que são apresentadas abaixo.</p>
<p>Para um dado conjunto de parâmetros <span class="math inline">\(\chi_N=\{\Delta, \mu, \rho, \omega, \zeta\}\)</span> a parametrização natural de um SVI é dada por:</p>
<span class="math display" id="eq:svi-natural">\[\begin{equation}
w(k; \chi_N)=\Delta+\frac{\omega}{2}\left\lbrace 1+\zeta\rho(k-\mu)+\sqrt{(\zeta(k-\mu)+\rho)^2+(1-\rho^2)} \right\rbrace
\tag{8.1}
\end{equation}\]</span>
<p>onde <span class="math inline">\(\omega\geq 0\)</span>, <span class="math inline">\(\Delta, \mu \in \mathbb R\)</span>, <span class="math inline">\(|\rho|&lt;1\)</span> e <span class="math inline">\(\zeta&gt;0\)</span>. A correspondência entre as parametrizações <em>raw</em> e natural é dada pelo seguinte mapeamento e seu inverso:</p>
<span class="math display" id="eq:natural-to-raw">\[\begin{equation}
(a, b, \rho, m, \sigma)=\left(\Delta+\frac{\omega}{2}(1-\rho^2), \frac{\omega\zeta}{2}, \rho, \mu-\frac{\rho}{\zeta}, \frac{\sqrt{1-\rho^2}}{\zeta}\right)
\tag{8.2}
\end{equation}\]</span>
<span class="math display" id="eq:raw-to-natural">\[\begin{equation}
(\Delta, \mu, \rho, \omega, \zeta)=\left(a-\frac{\omega}{2}(1-\rho^2), m+\frac{\rho\sigma}{\sqrt{1-\rho^2}}, \rho, \frac{2b\sigma}{\sqrt{1-\rho^2}}, \frac{\sqrt{1-\rho^2}}{\sigma}\right)
\tag{8.3}
\end{equation}\]</span>
<p>A desvantagem destas parametrizações é que o valor de seus parâmetros não são intuitivos para os <em>traders</em>, eles não carregam estes valores em sua memória durante a negociação. Valores característicos de uma superfície de volatilidade implícita que <em>traders</em> têm em mente são, por exemplo, volatilidade ATM, <em>skew</em> de volatilidade ATM e assíntotas. Desta forma a parametrização <em>Jump-Wings</em> é útil, pois relaciona estes valores típicos aos parâmetros <em>raw</em> de um SVI.</p>
<p>A parametrização <em>JW</em> é dada em termos da variância implícita (e não da variância total) e portanto existe uma dependência explícita do tempo em sua formulação. Para um dado tempo até a expiração, <span class="math inline">\(\tau\)</span>, o conjunto de parâmetros <span class="math inline">\(\chi_{J}=\{v_\tau, \psi_\tau, p_\tau, c_\tau, \tilde v_\tau\}\)</span> é definido pelas seguintes equações a partir dos parâmetros <em>raw</em>:</p>
<span class="math display" id="eq:raw-to-jw">\[\begin{align}
v_\tau&amp;=\frac{a+b\{-\rho m + \sqrt{m^2+\sigma^2}\}}{\tau},\\
\psi_\tau&amp;=\frac{1}{\sqrt{w_\tau}}\frac{b}{2}\left(-\frac{m}{\sqrt{m^2+\sigma^2}}+\rho\right),\\
p_\tau&amp;=\frac{1}{\sqrt{w_\tau}}b(1-\rho),\\
c_\tau&amp;=\frac{1}{\sqrt{w_\tau}}b(1+\rho),\\
\tilde v_\tau&amp;=\frac{1}{\tau}\left(a+b\sigma\sqrt{1-\rho^2}\right)
\tag{8.4}
\end{align}\]</span>
<p>onde <span class="math inline">\(w_\tau=v_\tau \tau\)</span> relaciona a variância total ATM com a variância ATM. Os parâmetros possuem as seguintes interpretações: <span class="math inline">\(v_\tau\)</span> é a variância ATM, <span class="math inline">\(\psi_\tau\)</span> o <em>skew</em> ATM, <span class="math inline">\(p_\tau\)</span> a inclinação da asa esquerda (puts), <span class="math inline">\(c_\tau\)</span> a inclinação da asa direita (calls) e <span class="math inline">\(\tilde v_\tau\)</span> é a variância implícita mínima.</p>
<p>A figura <a href="ssvi.html#fig:svi-jw">8.1</a> apresenta uma esquematização destes parâmetros sobre um <em>smile</em> fictício para melhor compreensão.</p>
<div class="figure"><span id="fig:svi-jw"></span>
<img src="images/svi_jw.png" alt="Interpretação dos parâmetros de um SVI-JW."  />
<p class="caption">
Figura 8.1: Interpretação dos parâmetros de um SVI-JW.
</p>
</div>
<p>As relações inversas que trazem uma parametrização <em>JW</em> para uma <em>raw</em>, assumindo que <span class="math inline">\(m \neq 0\)</span> são:</p>
<span class="math display" id="eq:jw-to-raw">\[\begin{align}
b&amp;=\frac{\sqrt{w_\tau}}{2}(c_\tau+p_\tau),\\
\rho&amp;=1-\frac{p_\tau\sqrt{w_\tau}}{b},\\
a&amp;=\tilde v_\tau \tau-b\sigma\sqrt{1-\rho^2},\\
m&amp;=\frac{(v_\tau-\tilde v_\tau)\tau}{b\left\lbrace-\rho+sign(\alpha)\sqrt{1+\alpha^2}-\alpha\sqrt{1-\rho^2}\right\rbrace},\\
\sigma&amp;=\alpha m.
\tag{8.5}
\end{align}\]</span>
<p>onde as variáveis auxiliares são definidas da seguinte forma: <span class="math inline">\(\beta:=\rho-(2\psi_\tau\sqrt{w_\tau})/b\)</span> e <span class="math inline">\(\alpha:=sign(\beta)\sqrt{1/\beta^2 - 1}\)</span>, com <span class="math inline">\(\beta \in [-1, 1]\)</span> para garantir a convexidade do <em>smile</em>.</p>
<p>Se <span class="math inline">\(m=0\)</span>, então as equações para <span class="math inline">\(a, b, \rho\)</span> se mantêm, porém, <span class="math inline">\(\sigma = (v_\tau \tau-a)/b\)</span>. Desta forma temos relações entre as três parametrizações SVI, sendo possível navegar entre elas com tranquilidade. Um <em>trader</em> pode verificar no mercado os valores dos parâmetros <em>JW</em> e traduzi-los para <em>raw</em> e simular o <em>smile</em> ou fazer o caminho reverso, calibrar uma fatia da superfície com parâmetros <em>raw</em>, traduzi-los para <em>JW</em> e apresentar para sua mesa, onde todos conseguirão interpretar os valores a que estão habituados.</p>
</div>
<div id="superficie-svi" class="section level2">
<h2><span class="header-section-number">8.2</span> Superfície SVI</h2>
<p>Uma SSVI surge como uma extensão à parametrização natural de um SVI, e fornece em uma única equação, a possibilidade de parametrizar uma superfície de volatilidade implícita por inteiro. É necessário, antes de mais nada, fazer algumas definições preliminares. Defina a variância total implícita no dinheiro (ATM) como <span class="math inline">\(\theta_\tau:=\sigma_{BS}^2(0, \tau)\tau\)</span> e <span class="math inline">\(\lim\limits_{\tau\rightarrow 0}\theta_\tau = 0\)</span>.</p>

<div class="definition">
<span id="def:ssvi" class="definition"><strong>Definição 8.1  </strong></span>Seja <span class="math inline">\(\varphi\)</span> uma função suave em <span class="math inline">\(\mathbb R_+^*\mapsto \mathbb R_+^*\)</span> tal que <span class="math inline">\(\lim\limits_{\tau\rightarrow 0}\theta_\tau \varphi(\theta_\tau)\)</span> exista em <span class="math inline">\(\mathbb R\)</span>. Uma SSVI é definida por:
</div>

<span class="math display" id="eq:ssvi">\[\begin{equation}
w(k, \theta_\tau)=\frac{\theta_\tau}{2}\left\lbrace 1+\rho\varphi(\theta_\tau)k+\sqrt{(\varphi(\theta_\tau)k+\rho)^2+(1-\rho^2)} \right\rbrace
\tag{8.6}
\end{equation}\]</span>
<p>Veja que na representação SSVI, engenhosamente os autores substituíram a dimensão de tempo, <span class="math inline">\(\tau\)</span>, típica de superfícies de volatilidde, pela variância total ATM. Com esta representação, eles conseguiram derivar as condições necessárias para a ausência de arbitragem estática na superfície e sempre que necessário, é possível retornar a dimensão de tempo no calendário.</p>
<p>Agora é necessário definir a função <span class="math inline">\(\varphi\)</span>, que então será substituída na equação <a href="ssvi.html#eq:ssvi">(8.6)</a> da definição <a href="ssvi.html#def:ssvi">8.1</a> com seus próprios parâmetros e teremos por fim uma função <span class="math inline">\(w(k, \theta_\tau; \chi_{ssvi})\)</span> que poderá ser calibrada para o conjunto de parâmetros da SSVI, <span class="math inline">\(\chi_{ssvi}\)</span> contra os dados observados no mercado. No fundo, qualquer função que obedeça as condições impostas na definição <a href="ssvi.html#def:ssvi">8.1</a> pode ser utilizada, entretanto os autores apresentam dois tipos de função que condizem com as observações empíricas.</p>
<div id="heston-1" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Heston</h3>
<p>Considere a função <span class="math inline">\(\varphi\)</span> definida por:</p>
<span class="math display" id="eq:heston-phi">\[\begin{equation}
\varphi(\theta)\equiv\frac{1}{\gamma\theta}\left\lbrace 1-\frac{1-e^{-\gamma\theta}}{\gamma\theta}\right\rbrace
\tag{8.7}
\end{equation}\]</span>
<p>com <span class="math inline">\(\gamma &gt; 0\)</span>. Esta função recebeu este nome pois, seu <em>skew</em> na variância implícita é compatível com aquele previsto no modelo de <a href="superficies.html#superficies">Heston</a>.</p>
</div>
<div id="lei-de-potencia" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Lei de potência</h3>
<p>A parametrização da função <span class="math inline">\(\varphi\)</span> como uma lei de potência é primeiramente considerada da seguinte forma: <span class="math inline">\(\varphi(\theta)=\eta\theta^{-\gamma}\)</span> com <span class="math inline">\(\eta &gt; 0\)</span> e <span class="math inline">\(0&lt;\gamma&lt;1\)</span>. Entretanto, esta parametrização apresenta algumas limitações com relação a arbitragem do tipo borboleta e então é proposta a seguinte forma funcional:</p>
<span class="math display" id="eq:pl-phi">\[\begin{equation}
\varphi(\theta)=\frac{\eta}{\theta^\gamma(1+\theta)^{1-\gamma}}
\tag{8.8}
\end{equation}\]</span>
<p>que é <strong>garantida</strong> não possuir arbitragem estática dado que <span class="math inline">\(\eta(1+|\rho|)\leq 2\)</span>.</p>
</div>
</div>
<div id="condicoes-de-nao-arbitragem" class="section level2">
<h2><span class="header-section-number">8.3</span> Condições de não-arbitragem</h2>
<p>As condições para ausência de arbitragem estática para uma SSVI são colocadas através de dois teoremas (4.1 e 4.2) e provadas no artigo de <span class="citation">(Gatheral and Jacquier <a href="#ref-Gatheral2014">2014</a>)</span>, dos quais resulta o seguinte corolário.</p>

<div class="corollary">
<span id="cor:ssvi-arbitrage" class="corollary"><strong>Corolario 8.1  </strong></span>A superfície SVI definida em <a href="ssvi.html#def:ssvi">8.1</a> está livre de arbitragem estática se as seguintes condições são satisfeitas:
</div>

<ol style="list-style-type: decimal">
<li><span class="math inline">\(\partial_\tau\theta_\tau\geq 0, \text{ para todo } \tau &gt; 0\)</span></li>
<li><span class="math inline">\(0\leq \partial_\theta(\theta\varphi(\theta))\leq\frac{1}{\rho^2}\left(1+\sqrt{1-\rho^2}\right)\varphi(\theta), \text{ para todo } \theta&gt;0\)</span></li>
<li><span class="math inline">\(\theta\varphi(\theta)(1+|\rho|)&lt;4, \text{ para todo } \theta&gt;0\)</span></li>
<li><span class="math inline">\(\theta\varphi(\theta)^2(1+|\rho|)\leq 4, \text{ para todo } \theta&gt;0\)</span></li>
</ol>
<p>Onde os dois primeiros itens dizem respeito a ausência de arbitragem de calendário, enquanto que os seguintes são exigências para a superfície estar livre de arbitragem do tipo borboleta.</p>
<p>Para uma função <span class="math inline">\(\varphi\)</span> do tipo Heston, as condições nos seus parâmetros são: <span class="math inline">\(\gamma&gt;0\)</span> que garante o atendimentos as condições 1 e 2 do corolário <a href="ssvi.html#cor:ssvi-arbitrage">8.1</a> e <span class="math inline">\(\gamma\geq(1+|\rho|)/4\)</span> para garantir a ausência de arbitragem borboleta, a qual subsume a primeira condição.</p>
<p>Para a função do tipo lei de potência dada em <a href="ssvi.html#eq:pl-phi">(8.8)</a> são necessárias as condições <span class="math inline">\(0&lt;\gamma&lt;1\)</span> e <span class="math inline">\(\eta(1+|\rho|)\leq 2\)</span></p>
<p>A maneira típica de impor as restrições dos parâmetros no momento da calibração do modelo é inserir uma penalidade na função objetivo, quando a restrição é violada. Por exemplo, consideramos a restrição de inequalidade para a lei de potência, <span class="math inline">\(\eta(1+|\rho|)-2\leq 0\)</span>. No momento da calibração, nós devemos calcular o valor desta expressão e se o seu resultado for maior que zero, uma penalidade é somada a função objetivo da calibração (em geral a soma dos quadrados dos erros).</p>
</div>
<div id="densidade-neutra-ao-risco" class="section level2">
<h2><span class="header-section-number">8.4</span> Densidade neutra ao risco</h2>
<p>Já comentamos sobre a <a href="smile.html#rnd">distribuição neutra ao risco</a> implícita no preço de opções que pode ser obtida através da fórmula de <span class="citation">(Breeden and Litzenberger <a href="#ref-Breeden1978">1978</a>)</span>, assim como já foi introduzida uma certa função <a href="svi.html#svi"><span class="math inline">\(g(k)\)</span></a> que desempenha um papel fundamental para garantir a ausência de arbitragem do tipo borboleta em <em>smiles</em> de variância total. O fato é que, para garantir a ausência de arbitragem a função <span class="math inline">\(g(k)\)</span> deve ser não negativa em todo o seu suporte <span class="math inline">\(k \in \mathbb R\)</span>. Ao mesmo tempo, a definição de ausência de arbitragem borboleta se confunde com o fato que a densidade neutra ao risco deve também ser não negativa, caso contrário não seria uma densidade de probabilidade. Logo percebe-se a estreita relação entre a função <span class="math inline">\(g(k)\)</span> e a densidade neutra ao risco implícita no preço de opções. De fato, a fórmula de Breeden-Litzenberger nos fornece:</p>
<span class="math display">\[\begin{equation}
p(k)=\left.\frac{\partial^2C_B(k, w(k))}{\partial K^2}\right|_{K=Fe^k} 
\end{equation}\]</span>
<p>que após fazer as derivações da equação de Black e as substituições e manipulações algébricas com as reparametrizações do modelo B&amp;S, resulta em:</p>
<span class="math display" id="eq:pk">\[\begin{equation}
p(k)=\frac{g(k)}{\sqrt{2\pi w(k)}}\exp\left(-\frac{d_2(k)^2}{2}\right)
\tag{5.12}
\end{equation}\]</span>
<p>E para relembrarmos, a função <span class="math inline">\(g(k)\)</span> é dada por:</p>
<span class="math display" id="eq:g">\[\begin{equation}
g(k)=\left(1-\frac{kw\prime(k)}{2w(k)}\right)^2-\frac{w\prime(k)^2}{4}\left(\frac{1}{w(k)}+\frac{1}{4}\right)+\frac{w\prime\prime(k)}{2}
\tag{7.5}
\end{equation}\]</span>
<p>Ou seja, uma vez parametrizado um SVI para um dado prazo de maturidade, <span class="math inline">\(\tau\)</span>, se torna simples a tarefa de extrair a densidade implícita. Possuímos a função <span class="math inline">\(w(k)\)</span> e suas derivadas e certamente <span class="math inline">\(d_2(k)\)</span>, bastando portanto, aplicar a equação <a href="superficies.html#eq:pk">(5.12)</a> para extrair importante informação do mercado de opções.</p>
</div>
<div id="superficie-de-volatilidade-local" class="section level2">
<h2><span class="header-section-number">8.5</span> Superfície de volatilidade local</h2>
<p>De maneira semelhante ao procedimento realizado com a densidade implícita, também é possível, uma vez parametrizada a SSVI, derivar a <strong>superfície de volatilidade local</strong> através da <a href="superficies.html#superficies">equação</a> de <span class="citation">(Dupire <a href="#ref-Dupire1994">1994</a>)</span>. Esta equação toma a seguinte forma funcional:</p>
<span class="math display" id="eq:dupire">\[\begin{equation}
\sigma_L^2(K, \tau)=\frac{\partial_\tau C_B(K, \tau)}{\frac{1}{2}K^2\partial_{KK}C_B(K, \tau)}
\tag{5.9}
\end{equation}\]</span>
<p>Novamente tomando as derivadas da equação de Black e fazendo as substituições necessárias<a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a> chegamos a relação entre a superfície SVI e variância local.</p>
<span class="math display" id="eq:var-local">\[\begin{equation}
\sigma^2_L(k, \tau)=\frac{\partial_\tau w(k, \theta_\tau)}{g(k, w(k, \theta_\tau))}
\tag{8.9}
\end{equation}\]</span>
<p>De forma bastante simplista, a superfície de volatilidade local pode ser entendida como aquela superfície de volatilidades instantâneas para o ativo subjacente, <span class="math inline">\(\sigma(S, t)\)</span> que depende tanto do nível de preço deste ativo quanto do tempo, e fornece a previsão do mercado para a volatilidade instantânea de <span class="math inline">\(S\)</span> dado que este ativo hoje está precificado em <span class="math inline">\(S_0\)</span> e no tempo futuro <span class="math inline">\(\tau\)</span> estará em <span class="math inline">\(K\)</span>. Fazendo uma analogia com o mercado de juros, a superfície local está para a curva <em>forward</em> assim como a superfície implícita está para a curva de juros, numa aproximação.</p>
<p>A superfície local é muito utilizada para precificar opções exóticas, aquelas que possuem perfil de <em>payoff</em> distinto das opções europeias e podem ou não terem seus resultados atrelados ao caminho seguido pelo preço do ativo objeto durante a vida da opção. Nestes casos, a precificação se dá através da incorporação da superfície local estipulando um valor de volatilidade instantânea para cada possível combinação <span class="math inline">\((S_t, t)\)</span> em geral em um ambiente de simulação de <a href="monte-carlo.html#monte-carlo">Monte Carlo</a>.</p>
<p>No caso da equação <a href="ssvi.html#eq:var-local">(8.9)</a> temos uma nova derivada a ser computada, <span class="math inline">\(\partial_\tau w(k, \theta_\tau)\)</span>, que só poderia ser feita de forma analítica caso <span class="math inline">\(\theta_\tau\)</span> fosse parametrizada explicitamente. Nem sempre este é o caso, já que <span class="math inline">\(\theta_\tau\)</span> são os valores de variância total ATM implícitas, ou seja, observa-se no mercado apenas alguns <strong>pontos</strong> de <span class="math inline">\(\theta_\tau\)</span>, pontos estes que podem estar espaçados em intervalos diferentes de tempo. A solução para esta derivação é interpolar estes pontos, nem que seja uma simples interpolação linear, e então fazer a derivação de forma numérica através de um método de diferenças finitas. Note que na interpolação deve-se garantir a condição de não arbitragem de calendário, <span class="math inline">\(\partial_\tau\theta_\tau\geq 0\)</span>.</p>
</div>
<div id="calibracao-da-ssvi" class="section level2">
<h2><span class="header-section-number">8.6</span> Calibração da SSVI</h2>
<p>Vamos retomar nosso exemplo de superfície de volatilidade do <a href="svi.html#svi">artigo anterior</a>, porém agora com todas as datas de expiração, ou seja, a superfície completa. Os códigos <a href="https://cran.r-project.org/">R</a> apresentados abaixo ajudam na compreensão do procedimento.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(purrr)
<span class="kw">library</span>(kableExtra)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(plot3D)
<span class="kw">source</span>(<span class="st">&#39;svi.R&#39;</span>)
<span class="kw">source</span>(<span class="st">&#39;ssvi.R&#39;</span>)</code></pre></div>
<p>Primeiramente foram carregados os pacotes necessários para a leitura e manipulação dos dados (<code>readr</code>, <code>dplyr</code> e <code>purrr</code>) assim como os pacotes de visualização (<code>kableExtra</code>, <code>ggplot2</code>, <code>ggthemes</code> e <code>plot3D</code>). Em seguida os arquivos <code>svi.R</code> e <code>ssvi.R</code> são implementações do <a href="http://clubedefinancas.com.br/">Clube de Finanças</a> para as funções necessárias para calibrar uma SSVI.</p>
<p>Carregados os pacotes e as funções, deve-se carregar os dados da superfície de volatilidade e organizá-los da forma que necessitamos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ssvi_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;./R/input/IV_Raw_Delta_surface.csv&quot;</span>,
                     <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">date =</span> <span class="kw">col_date</span>(<span class="dt">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tau =</span> period <span class="op">/</span><span class="st"> </span><span class="dv">365</span>,
         <span class="dt">theta =</span> <span class="kw">theta_vec</span>(moneyness, tau, iv)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">k =</span> moneyness)</code></pre></div>
<p>Para calibrar os parâmetros de uma SSVI, com a função <span class="math inline">\(\varphi\)</span> do tipo <strong>lei de potência</strong>, necessitaremos dos dados de <em>moneyness</em> (<span class="math inline">\(k\)</span>), vencimento (<span class="math inline">\(\tau\)</span>) e volatilidade implícita (<span class="math inline">\(iv\)</span>) que será internamente convertida em variância total implícita (<span class="math inline">\(w\)</span>). Dentro da função de ajuste dos parâmetros <code>fit_ssvi()</code> a variância total ATM implícita <span class="math inline">\(\theta_\tau\)</span> é calculada através de interpolação <em>spline</em> para cada uma das fatias da superfície, pois, nossos dados não necessariamente possuem esta observação. Cabe ressaltar também que os dados estão organizados de forma <code>tidy</code>, sendo portanto, todos os argumentos passados para as funções na forma de vetores, não sendo necessário gerar uma matriz contendo o <em>grid</em> <span class="math inline">\((k, \tau)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k &lt;-<span class="st"> </span>ssvi_data<span class="op">$</span>k
tau &lt;-<span class="st"> </span>ssvi_data<span class="op">$</span>tau
iv &lt;-<span class="st"> </span>ssvi_data<span class="op">$</span>iv
theta &lt;-<span class="st"> </span>ssvi_data<span class="op">$</span>theta

<span class="kw">set.seed</span>(<span class="dv">12345</span>)
powerlaw_par &lt;-<span class="st"> </span><span class="kw">fit_ssvi</span>(tau, k, iv, <span class="st">&quot;powerlaw&quot;</span>)
<span class="kw">kable</span>(powerlaw_par,
      <span class="dt">caption =</span> <span class="st">&quot;Parâmetros da SSVI-power-law estimados.&quot;</span>,
      <span class="dt">col.names =</span> <span class="st">&quot;SSVI-PL&quot;</span>)</code></pre></div>
<table>
<caption>
<span id="tab:ssvi-cal">Tabela 8.1: </span>Parâmetros da SSVI-power-law estimados.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
SSVI-PL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rho
</td>
<td style="text-align:right;">
0.1183545
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
eta
</td>
<td style="text-align:right;">
1.7883417
</td>
</tr>
</tbody>
</table>
<p>Podemos rapidamente checar se estes parâmetros estimados geram uma superfície livre de arbitragem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;Parametrização livre de arbitragem borboleta? :&quot;</span>, 
      <span class="kw">ssvi_butterfly_cons</span>(powerlaw_par, <span class="st">&quot;powerlaw&quot;</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] &quot;Parametrização livre de arbitragem borboleta? : TRUE&quot;</code></pre>
<p>Com os parâmetros estimados, é simples plotar todos os <em>smiles</em> que compõe a superfície e verificar visualmente o ajuste. Vamos plotar a <strong>variância total</strong> em função do <em>moneyness</em> e vencimentos, pois neste gráfico se verifica a condição de arbitragem de calendário simplesmente através do fato que as curvas geradas não devem se cruzar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plt_df &lt;-<span class="st"> </span>ssvi_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">w_pl =</span> <span class="kw">ssvi_fun</span>(powerlaw_par, theta, k)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(k, tau, w_pl, iv) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(tau <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)

<span class="kw">ggplot</span>(plt_df, <span class="kw">aes</span>(<span class="dt">x =</span> k, <span class="dt">y =</span> w_pl)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="kw">as.factor</span>(<span class="kw">format</span>(tau, <span class="dt">digits =</span> <span class="dv">3</span>)))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> iv<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>tau)) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Vencimento&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;SSVI Lei de Potência&quot;,</span>
<span class="st">       x = &quot;</span>Forward log<span class="op">-</span><span class="kw">moneyness</span> (k)<span class="st">&quot;,</span>
<span class="st">       y = &quot;</span>Variância total implí<span class="kw">cita</span> (w)<span class="st">&quot;,</span>
<span class="st">       caption = &quot;</span>Elaborado por Rafael Bressan para o Clube de Finanças.<span class="st">&quot;) +</span>
<span class="st">#  scale_y_continuous(labels = scales::percent) +</span>
<span class="st">  scale_color_viridis_d() +</span>
<span class="st">  theme_economist_white()</span></code></pre></div>
<p><img src="08-superficie-svi_files/figure-html/ssvi_plot-1.png" width="672" /></p>
<p>Foram retirados os vencimentos mais longos apenas para uma melhor visualização da parte mais curta da superfície, que em geral é a mais complicada de se calibrar através de SVI. O resultado parece interessante, com as variâncias ao redor do dinheiro tendo boa aderência aos dados observados, porém para <em>puts</em> muito fora do dinheiro, a parametrização aparenta <strong>subestimar</strong> o valor da variância total e portanto estaria subprecificando as opções.</p>
<p>Iremos agora verificar a <em>densidade da distribuição implícita</em> para o período de vencimento de 90 dias. Utiliza-se para tanto a equação <a href="superficies.html#eq:pk">(5.12)</a> onde <span class="math inline">\(w(k)\)</span> (e suas derivadas e o próprio <span class="math inline">\(d_2\)</span>) será agora calculado com base nos parâmetros da tabela <a href="ssvi.html#tab:ssvi-cal">8.1</a> para um vetor de <em>moneyness</em> mais amplo e denso. O resultado pode ser observado através da figura <a href="ssvi.html#fig:ssvi-dens">8.2</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">thetadens &lt;-<span class="st"> </span>ssvi_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(period <span class="op">==</span><span class="st"> </span><span class="dv">90</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pull</span>(theta) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  `</span><span class="dt">[</span><span class="st">`</span>(<span class="dv">1</span>)
kdens &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)
dens &lt;-<span class="st"> </span><span class="kw">ssvi_density</span>(powerlaw_par, thetadens, kdens, <span class="st">&quot;powerlaw&quot;</span>)
dens_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">kdens =</span> kdens, <span class="dt">dens =</span> dens)

<span class="kw">ggplot</span>(dens_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> kdens, <span class="dt">y =</span> dens)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Densidade neutra ao risco SSVI&quot;</span>,
     <span class="dt">x =</span> <span class="st">&quot;Forward log-moneyness (k)&quot;</span>,
     <span class="dt">y =</span> <span class="st">&quot;Densidade&quot;</span>,
     <span class="dt">caption =</span> <span class="st">&quot;Elaborado por Rafael Bressan para o Clube de Finanças.&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_economist_white</span>()</code></pre></div>
<div class="figure"><span id="fig:ssvi-dens"></span>
<img src="08-superficie-svi_files/figure-html/ssvi-dens-1.png" alt="Densidade implícita estimada. Presença de assimetria e leptocurtose a esquerda." width="672" />
<p class="caption">
Figura 8.2: Densidade implícita estimada. Presença de assimetria e leptocurtose a esquerda.
</p>
</div>
<p>Este é um gráfico interessante, que nos mostra exatamente o que se espera de um <em>smile</em> típico de <em>equities</em> que possui <em>skew</em> negativo. Percebemos como a densidade de probabilidades é assimétrica, com a cauda esquerda muito mais longa, refletindo o sentimento de mercado de uma maior probabilidade de grandes quedas no preço do ativo objeto que altas equivalentes. Sempre que verificamos um <em>smile</em> com <em>skew</em> negativo, como é o presente caso, a distribuição de probabilidades é assimétrica a esquerda.</p>
<p>Vamos conferir se a área sob esta curva de densidade integra aproximadamente 1, como deve ser.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">area &lt;-<span class="st"> </span><span class="kw">integrate</span>(<span class="cf">function</span>(x) <span class="kw">ssvi_density</span>(powerlaw_par, thetadens, x, <span class="st">&quot;powerlaw&quot;</span>),
                  <span class="dt">lower =</span> kdens[<span class="dv">1</span>],
                  <span class="dt">upper =</span> kdens[<span class="kw">length</span>(kdens)])
<span class="kw">paste</span>(<span class="st">&quot;Área sob a curva de densidade é: &quot;</span>, area<span class="op">$</span>value)</code></pre></div>
<p>[1] “Área sob a curva de densidade é: 0.999993065215889”</p>
<p>Chegou o momento de inferirmos a <strong>superfície de volatilidade local</strong> a partir de nossa parametrização SSVI. O método será a aplicação direta da equação <a href="ssvi.html#eq:var-local">(8.9)</a> pois, com a parametrização realizada, dispomos de todos os dados necessários para seu cômputo.</p>
<p>Antes porém, devemos observar uma peculiaridade dos nossos dados. O site <a href="https://ivolatility.com">ivolatility.com</a> fornece dados alinhados por <strong>Delta</strong>, ou seja, para cada período de vencimento temos um mesmo conjunto de Deltas, <strong>mas não de moneyness</strong>. Os valores deste último irá variar conforme o vencimento, uma vez que pela definição de <em>forward log-moneyness</em> que vimos utilizando é dependente do tempo para maturidade da opção. Desta forma precisamos gerar um novo <em>grid</em> <span class="math inline">\((k, \tau)\)</span> para plotar nossa superfície de volatilidade local.</p>
<p>Para tanto, criaremos uma sequência uniforme de valores de <span class="math inline">\(k\)</span> e tomaremos os valores que já possuímos de <span class="math inline">\(\tau\)</span> e <span class="math inline">\(\theta_\tau\)</span> recombinando-os através da função <code>expand.grid()</code> para gerar o data frame que precisamos.</p>
<p>Feito isso, é apenas questão de aplicar a equação <a href="ssvi.html#eq:var-local">(8.9)</a> e criar uma matriz (pois assim pede a função <code>surf3D()</code>) com os valores da volatilidade local.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kloc &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span>.<span class="dv">4</span>, <span class="fl">0.4</span>, <span class="dt">length.out =</span> <span class="dv">17</span>)
utau &lt;-<span class="st"> </span><span class="kw">unique</span>(tau)
utheta &lt;-<span class="st"> </span><span class="kw">unique</span>(theta)
<span class="kw">names</span>(utheta) &lt;-<span class="st"> </span>utau  <span class="co"># utheta will be a lookup vector</span>
grid_df &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(kloc, utau) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">kloc =</span> Var1,
         <span class="dt">tau =</span> Var2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta =</span> utheta[<span class="kw">as.character</span>(tau)])

loc_vol_vec &lt;-<span class="st"> </span><span class="kw">ssvi_local_vol</span>(powerlaw_par, 
                              grid_df<span class="op">$</span>tau, 
                              grid_df<span class="op">$</span>theta, 
                              grid_df<span class="op">$</span>kloc, 
                              <span class="st">&quot;powerlaw&quot;</span>)
<span class="co"># Matrix where k is row</span>
loc_vol_m &lt;-<span class="st"> </span><span class="kw">matrix</span>(loc_vol_vec, <span class="dt">nrow =</span> <span class="kw">length</span>(kloc))  

<span class="co"># Plot Local Volatility Surface</span>
<span class="co"># x is k, y is tau</span>
M &lt;-<span class="st"> </span><span class="kw">mesh</span>(kloc, utau)
<span class="kw">surf3D</span>(M<span class="op">$</span>x, M<span class="op">$</span>y, loc_vol_m, <span class="dt">colkey =</span> <span class="ot">FALSE</span>, <span class="dt">bty =</span> <span class="st">&quot;b2&quot;</span>, 
       <span class="dt">phi =</span> <span class="dv">20</span>, <span class="dt">ticktype =</span> <span class="st">&quot;detailed&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;k&quot;</span>,
       <span class="dt">ylab =</span> <span class="st">&quot;\u03c4&quot;</span>,
       <span class="dt">zlab =</span> <span class="st">&quot;Volatilidade local \u03c3&quot;</span>)</code></pre></div>
<p><img src="08-superficie-svi_files/figure-html/vol-local-1.png" width="672" /></p>
</div>
<div id="conclusao-4" class="section level2">
<h2><span class="header-section-number">8.7</span> Conclusão</h2>
<p>Apresentamos o modelo de superfícies SVI, que faz uma generalização dos <em>smiles</em> SVI e apresenta vantagens sobre a parametrização fatia-a-fatia em virtude dos teoremas sobre arbitragem estática, apresentando restrições para os parâmetros do modelo que garantem a ausência deste tipo de arbitragem.</p>
<p>Uma vez parametrizada toda uma SSVI, torna-se simples, uma mera aplicação de fórmulas a obtenção tanto da densidade da distribuição neutra ao risco implícita no preços das opções, como da superfície de volatilidade local através da equação de Dupire.</p>
</div>
<div id="referencias-1" class="section level2">
<h2><span class="header-section-number">8.8</span> Referências</h2>

</div>
</div>
<h3>Bibliografia</h3>
<div id="refs" class="references">
<div id="ref-Breeden1978">
<p>Breeden, Douglas T, and Robert H Litzenberger. 1978. “Prices of State-Contingent Claims Implicit in Option Prices.” <em>Journal of Business</em>. JSTOR, 621–51.</p>
</div>
<div id="ref-Dupire1994">
<p>Dupire, Bruno. 1994. “Pricing with a Smile.” <em>Risk</em> 7 (1): 18–20.</p>
</div>
<div id="ref-Gatheral2004">
<p>Gatheral, Jim. 2004. “A Parsimonious Arbitrage-Free Implied Volatility Parameterization with Application to the Valuation of Volatility Derivatives.” <em>Presentation at Global Derivatives &amp; Risk Management, Madrid</em>.</p>
</div>
<div id="ref-Gatheral2014">
<p>Gatheral, Jim, and Antoine Jacquier. 2014. “Arbitrage-Free Svi Volatility Surfaces.” <em>Quantitative Finance</em> 14 (1). Taylor &amp; Francis: 59–71.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="16">
<li id="fn16"><p>Referimos o leitor ao material do prof. Antoine Jacquier para uma prova desta relação <a href="http://wwwf.imperial.ac.uk/~ajacquie/IC_AMDP/IC_AMDP_Docs/AMDP.pdf">aqui</a><a href="ssvi.html#fnref16">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="svi.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rfbressan/vol_surface_gitbook/edit/master/08-superficie-svi.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["vol_surface_book.pdf", "vol_surface_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
